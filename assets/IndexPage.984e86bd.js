import{Q as bt}from"./QResizeObserver.e23cf5d2.js";import{Q as Dt,a as Ut}from"./QFab.01b0329d.js";import{i as qt,R as j,S as zt,c as F,g as Vt,x as Qt,h as nt,s as Rt,aw as Ht,ax as z,ay as at,az as Kt,aA as st,aB as jt,aC as Wt,aD as R,aE as Lt,aF as Zt,aG as W,aH as Jt,aI as te,_ as Y,j as C,H as A,I as y,l as ee,aJ as ne,am as re,aK as It,r as x,ag as v,d,aL as pt,k as V,Q as oe,M as ie,K as Z,L as $,ah as Tt,aM as At,P as rt,aN as ae,F as Q,aO as se,aP as le,m as Ft,aQ as Mt,af as ue}from"./index.f9934e58.js";import{E as kt,B as ce,G as M,d as St,S as lt,l as Bt,n as he,e as H,P as ut,i as fe,a as pe,b as ge,f as de,c as ve,g as ot,V as Xt,h as gt,j as _e,O as ye,u as dt,k as me,m as xe,T as Ee,F as it,C as Ce,o as we}from"./CartoLayers.47566543.js";import{Q as Re}from"./QPage.55d7df34.js";import{u as Le}from"./custom-location-store.a0cefb23.js";const Ie={position:{type:String,default:"bottom-right",validator:r=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(r)},offset:{type:Array,validator:r=>r.length===2},expand:Boolean};function Te(){const{props:r,proxy:{$q:e}}=Vt(),t=qt(zt,j);if(t===j)return console.error("QPageSticky needs to be child of QLayout"),j;const n=F(()=>{const h=r.position;return{top:h.indexOf("top")>-1,right:h.indexOf("right")>-1,bottom:h.indexOf("bottom")>-1,left:h.indexOf("left")>-1,vertical:h==="top"||h==="bottom",horizontal:h==="left"||h==="right"}}),o=F(()=>t.header.offset),i=F(()=>t.right.offset),a=F(()=>t.footer.offset),s=F(()=>t.left.offset),l=F(()=>{let h=0,p=0;const f=n.value,g=e.lang.rtl===!0?-1:1;f.top===!0&&o.value!==0?p=`${o.value}px`:f.bottom===!0&&a.value!==0&&(p=`${-a.value}px`),f.left===!0&&s.value!==0?h=`${g*s.value}px`:f.right===!0&&i.value!==0&&(h=`${-g*i.value}px`);const _={transform:`translate(${h}, ${p})`};return r.offset&&(_.margin=`${r.offset[1]}px ${r.offset[0]}px`),f.vertical===!0?(s.value!==0&&(_[e.lang.rtl===!0?"right":"left"]=`${s.value}px`),i.value!==0&&(_[e.lang.rtl===!0?"left":"right"]=`${i.value}px`)):f.horizontal===!0&&(o.value!==0&&(_.top=`${o.value}px`),a.value!==0&&(_.bottom=`${a.value}px`)),_}),u=F(()=>`q-page-sticky row flex-center fixed-${r.position} q-page-sticky--${r.expand===!0?"expand":"shrink"}`);function c(h){const p=Qt(h.default);return nt("div",{class:u.value,style:l.value},r.expand===!0?p:[nt("div",p)])}return{$layout:t,getStickyContent:c}}var J=Rt({name:"QPageSticky",props:Ie,setup(r,{slots:e}){const{getStickyContent:t}=Te();return()=>t(e)}}),P={ADD:"add",REMOVE:"remove"},Pt=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),vt={LENGTH:"length"},D=function(r){Pt(e,r);function e(t,n,o){var i=r.call(this,t)||this;return i.element=n,i.index=o,i}return e}(kt),Ae=function(r){Pt(e,r);function e(t,n){var o=r.call(this)||this;o.on,o.once,o.un;var i=n||{};if(o.unique_=!!i.unique,o.array_=t||[],o.unique_)for(var a=0,s=o.array_.length;a<s;++a)o.assertUnique_(o.array_[a],a);return o.updateLength_(),o}return e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var n=0,o=t.length;n<o;++n)this.push(t[n]);return this},e.prototype.forEach=function(t){for(var n=this.array_,o=0,i=n.length;o<i;++o)t(n[o],o,n)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(vt.LENGTH)},e.prototype.insertAt=function(t,n){this.unique_&&this.assertUnique_(n),this.array_.splice(t,0,n),this.updateLength_(),this.dispatchEvent(new D(P.ADD,n,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var n=this.getLength();return this.insertAt(n,t),this.getLength()},e.prototype.remove=function(t){for(var n=this.array_,o=0,i=n.length;o<i;++o)if(n[o]===t)return this.removeAt(o)},e.prototype.removeAt=function(t){var n=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new D(P.REMOVE,n,t)),n},e.prototype.setAt=function(t,n){var o=this.getLength();if(t<o){this.unique_&&this.assertUnique_(n,t);var i=this.array_[t];this.array_[t]=n,this.dispatchEvent(new D(P.REMOVE,i,t)),this.dispatchEvent(new D(P.ADD,n,t))}else{for(var a=o;a<t;++a)this.insertAt(a,void 0);this.insertAt(t,n)}},e.prototype.updateLength_=function(){this.set(vt.LENGTH,this.array_.length)},e.prototype.assertUnique_=function(t,n){for(var o=0,i=this.array_.length;o<i;++o)if(this.array_[o]===t&&o!==n)throw new Ht(58)},e}(ce),Fe=Ae;function _t(r,e,t,n,o,i,a){var s=r[e],l=r[e+1],u=r[t]-s,c=r[t+1]-l,h;if(u===0&&c===0)h=e;else{var p=((o-s)*u+(i-l)*c)/(u*u+c*c);if(p>1)h=t;else if(p>0){for(var f=0;f<n;++f)a[f]=at(r[e+f],r[t+f],p);a.length=n;return}else h=e}for(var f=0;f<n;++f)a[f]=r[h+f];a.length=n}function ct(r,e,t,n,o){var i=r[e],a=r[e+1];for(e+=n;e<t;e+=n){var s=r[e],l=r[e+1],u=z(i,a,s,l);u>o&&(o=u),i=s,a=l}return o}function Me(r,e,t,n,o){for(var i=0,a=t.length;i<a;++i){var s=t[i];o=ct(r,e,s,n,o),e=s}return o}function ht(r,e,t,n,o,i,a,s,l,u,c){if(e==t)return u;var h,p;if(o===0)if(p=z(a,s,r[e],r[e+1]),p<u){for(h=0;h<n;++h)l[h]=r[e+h];return l.length=n,p}else return u;for(var f=c||[NaN,NaN],g=e+n;g<t;)if(_t(r,g-n,g,n,a,s,f),p=z(a,s,f[0],f[1]),p<u){for(u=p,h=0;h<n;++h)l[h]=f[h];l.length=n,g+=n}else g+=n*Math.max((Math.sqrt(p)-Math.sqrt(u))/o|0,1);if(i&&(_t(r,t-n,e,n,a,s,f),p=z(a,s,f[0],f[1]),p<u)){for(u=p,h=0;h<n;++h)l[h]=f[h];l.length=n}return u}function ke(r,e,t,n,o,i,a,s,l,u,c){for(var h=c||[NaN,NaN],p=0,f=t.length;p<f;++p){var g=t[p];u=ht(r,e,g,n,o,i,a,s,l,u,h),e=g}return u}function Yt(r,e,t,n,o,i,a){var s=(t-e)/n;if(s<3){for(;e<t;e+=n)i[a++]=r[e],i[a++]=r[e+1];return a}var l=new Array(s);l[0]=1,l[s-1]=1;for(var u=[e,t-n],c=0;u.length>0;){for(var h=u.pop(),p=u.pop(),f=0,g=r[p],_=r[p+1],E=r[h],k=r[h+1],m=p+n;m<h;m+=n){var L=r[m],I=r[m+1],N=Kt(L,I,g,_,E,k);N>f&&(c=m,f=N)}f>o&&(l[(c-e)/n]=1,p+n<c&&u.push(p,c),c+n<h&&u.push(c,h))}for(var m=0;m<s;++m)l[m]&&(i[a++]=r[e+m*n],i[a++]=r[e+m*n+1]);return a}function S(r,e){return e*Math.round(r/e)}function Se(r,e,t,n,o,i,a){if(e==t)return a;var s=S(r[e],o),l=S(r[e+1],o);e+=n,i[a++]=s,i[a++]=l;var u,c;do if(u=S(r[e],o),c=S(r[e+1],o),e+=n,e==t)return i[a++]=u,i[a++]=c,a;while(u==s&&c==l);for(;e<t;){var h=S(r[e],o),p=S(r[e+1],o);if(e+=n,!(h==u&&p==c)){var f=u-s,g=c-l,_=h-s,E=p-l;if(f*E==g*_&&(f<0&&_<f||f==_||f>0&&_>f)&&(g<0&&E<g||g==E||g>0&&E>g)){u=h,c=p;continue}i[a++]=u,i[a++]=c,s=u,l=c,u=h,c=p}}return i[a++]=u,i[a++]=c,a}function Be(r,e,t,n,o,i,a,s){for(var l=0,u=t.length;l<u;++l){var c=t[l];a=Se(r,e,c,n,o,i,a),s.push(a),e=c}return a}function ft(r,e,t,n,o){for(var i=o!==void 0?o:[],a=0,s=e;s<t;s+=n)i[a++]=r.slice(s,s+n);return i.length=a,i}function Xe(r,e,t,n,o){for(var i=o!==void 0?o:[],a=0,s=0,l=t.length;s<l;++s){var u=t[s];i[a++]=ft(r,e,u,n,i[a]),e=u}return i.length=a,i}function Nt(r,e,t,n){for(var o=0,i=r[t-n],a=r[t-n+1];e<t;e+=n){var s=r[e],l=r[e+1];o+=a*s-i*l,i=s,a=l}return o/2}function Pe(r,e,t,n){for(var o=0,i=0,a=t.length;i<a;++i){var s=t[i];o+=Nt(r,e,s,n),e=s}return o}var Ye=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ne=function(r){Ye(e,r);function e(t,n){var o=r.call(this)||this;return o.maxDelta_=-1,o.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(t[0])?o.setFlatCoordinates(n,t):o.setCoordinates(t,n),o}return e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,n,o,i){return i<st(this.getExtent(),t,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ct(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ht(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,n,o,i))},e.prototype.getArea=function(){return Nt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return ft(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=Yt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,M.XY)},e.prototype.getType=function(){return"LinearRing"},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=St(this.flatCoordinates,0,t,this.stride),this.changed()},e}(lt),yt=Ne;function $e(r,e,t,n,o,i,a){for(var s,l,u,c,h,p,f,g=o[i+1],_=[],E=0,k=t.length;E<k;++E){var m=t[E];for(c=r[m-n],p=r[m-n+1],s=e;s<m;s+=n)h=r[s],f=r[s+1],(g<=p&&f<=g||p<=g&&g<=f)&&(u=(g-p)/(f-p)*(h-c)+c,_.push(u)),c=h,p=f}var L=NaN,I=-1/0;for(_.sort(he),c=_[0],s=1,l=_.length;s<l;++s){h=_[s];var N=Math.abs(h-c);N>I&&(u=(c+h)/2,Bt(r,e,t,n,u,g)&&(L=u,I=N)),c=h}return isNaN(L)&&(L=o[i]),a?(a.push(L,g,I),a):[L,g,I]}function Oe(r,e,t,n){for(;e<t-n;){for(var o=0;o<n;++o){var i=r[e+o];r[e+o]=r[t-n+o],r[t-n+o]=i}e+=n,t-=n}}function $t(r,e,t,n){for(var o=0,i=r[t-n],a=r[t-n+1];e<t;e+=n){var s=r[e],l=r[e+1];o+=(s-i)*(l+a),i=s,a=l}return o===0?void 0:o>0}function Ge(r,e,t,n,o){for(var i=o!==void 0?o:!1,a=0,s=t.length;a<s;++a){var l=t[a],u=$t(r,e,l,n);if(a===0){if(i&&u||!i&&!u)return!1}else if(i&&!u||!i&&u)return!1;e=l}return!0}function mt(r,e,t,n,o){for(var i=o!==void 0?o:!1,a=0,s=t.length;a<s;++a){var l=t[a],u=$t(r,e,l,n),c=a===0?i&&u||!i&&!u:i&&!u||!i&&u;c&&Oe(r,e,l,n),e=l}return e}var be=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),De=function(r){be(e,r);function e(t,n,o){var i=r.call(this)||this;return i.ends_=[],i.flatInteriorPointRevision_=-1,i.flatInteriorPoint_=null,i.maxDelta_=-1,i.maxDeltaRevision_=-1,i.orientedRevision_=-1,i.orientedFlatCoordinates_=null,n!==void 0&&o?(i.setFlatCoordinates(n,t),i.ends_=o):i.setCoordinates(t,n),i}return e.prototype.appendLinearRing=function(t){this.flatCoordinates?H(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,o,i){return i<st(this.getExtent(),t,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Me(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ke(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,n,o,i))},e.prototype.containsXY=function(t,n){return Bt(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,n)},e.prototype.getArea=function(){return Pe(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var n;return t!==void 0?(n=this.getOrientedFlatCoordinates().slice(),mt(n,0,this.ends_,this.stride,t)):n=this.flatCoordinates,Xe(n,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=jt(this.getExtent());this.flatInteriorPoint_=$e(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new ut(this.getFlatInteriorPoint(),M.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new yt(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,n=this.flatCoordinates,o=this.ends_,i=[],a=0,s=0,l=o.length;s<l;++s){var u=o[s],c=new yt(n.slice(a,u),t);i.push(c),a=u}return i},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Ge(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=mt(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[],o=[];return n.length=Be(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),n,0,o),new e(n,M.XY,o)},e.prototype.getType=function(){return"Polygon"},e.prototype.intersectsExtent=function(t){return fe(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var o=pe(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=o.length===0?0:o[o.length-1],this.changed()},e}(lt);function Ue(r,e,t,n){for(var o=t||32,i=[],a=0;a<o;++a)H(i,Wt(r,e,2*Math.PI*a/o,n));return i.push(i[0],i[1]),new De(i,M.XY,[i.length])}function qe(r,e,t,n,o,i,a){var s,l,u=(t-e)/n;if(u===1)s=e;else if(u===2)s=e,l=o;else if(u!==0){for(var c=r[e],h=r[e+1],p=0,f=[0],g=e+n;g<t;g+=n){var _=r[g],E=r[g+1];p+=Math.sqrt((_-c)*(_-c)+(E-h)*(E-h)),f.push(p),c=_,h=E}var k=o*p,m=ge(f,k);m<0?(l=(k-f[-m-2])/(f[-m-1]-f[-m-2]),s=e+(-m-2)*n):s=e+m*n}for(var L=a>1?a:2,I=i||new Array(L),g=0;g<L;++g)I[g]=s===void 0?NaN:l===void 0?r[s+g]:at(r[s+g],r[s+n+g],l);return I}function ze(r,e,t,n,o,i){if(t==e)return null;var a;if(o<r[e+n-1])return i?(a=r.slice(e,e+n),a[n-1]=o,a):null;if(r[t-1]<o)return i?(a=r.slice(t-n,t),a[n-1]=o,a):null;if(o==r[e+n-1])return r.slice(e,e+n);for(var s=e/n,l=t/n;s<l;){var u=s+l>>1;o<r[(u+1)*n-1]?l=u:s=u+1}var c=r[s*n-1];if(o==c)return r.slice((s-1)*n,(s-1)*n+n);var h=r[(s+1)*n-1],p=(o-c)/(h-c);a=[];for(var f=0;f<n-1;++f)a.push(at(r[(s-1)*n+f],r[s*n+f],p));return a.push(o),a}function Ve(r,e,t,n){for(var o=r[e],i=r[e+1],a=0,s=e+n;s<t;s+=n){var l=r[s],u=r[s+1];a+=Math.sqrt((l-o)*(l-o)+(u-i)*(u-i)),o=l,i=u}return a}var Qe=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),He=function(r){Qe(e,r);function e(t,n){var o=r.call(this)||this;return o.flatMidpoint_=null,o.flatMidpointRevision_=-1,o.maxDelta_=-1,o.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(t[0])?o.setFlatCoordinates(n,t):o.setCoordinates(t,n),o}return e.prototype.appendCoordinate=function(t){this.flatCoordinates?H(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,o,i){return i<st(this.getExtent(),t,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ct(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ht(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,n,o,i))},e.prototype.forEachSegment=function(t){return de(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,n){if(this.layout!=M.XYM&&this.layout!=M.XYZM)return null;var o=n!==void 0?n:!1;return ze(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,o)},e.prototype.getCoordinates=function(){return ft(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,n){return qe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,this.stride)},e.prototype.getLength=function(){return Ve(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=Yt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,M.XY)},e.prototype.getType=function(){return"LineString"},e.prototype.intersectsExtent=function(t){return ve(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=St(this.flatCoordinates,0,t,this.stride),this.changed()},e}(lt),xt=He;function Ke(r,e,t,n,o){Ot(r,e,t||0,n||r.length-1,o||je)}function Ot(r,e,t,n,o){for(;n>t;){if(n-t>600){var i=n-t+1,a=e-t+1,s=Math.log(i),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(i-l)/i)*(a-i/2<0?-1:1),c=Math.max(t,Math.floor(e-a*l/i+u)),h=Math.min(n,Math.floor(e+(i-a)*l/i+u));Ot(r,e,c,h,o)}var p=r[e],f=t,g=n;for(O(r,t,e),o(r[n],p)>0&&O(r,t,n);f<g;){for(O(r,f,g),f++,g--;o(r[f],p)<0;)f++;for(;o(r[g],p)>0;)g--}o(r[t],p)===0?O(r,t,g):(g++,O(r,g,n)),g<=e&&(t=g+1),e<=g&&(n=g-1)}}function O(r,e,t){var n=r[e];r[e]=r[t],r[t]=n}function je(r,e){return r<e?-1:r>e?1:0}class We{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const n=[];if(!q(e,t))return n;const o=this.toBBox,i=[];for(;t;){for(let a=0;a<t.children.length;a++){const s=t.children[a],l=t.leaf?o(s):s;q(e,l)&&(t.leaf?n.push(s):et(e,l)?this._all(s,n):i.push(s))}t=i.pop()}return n}collides(e){let t=this.data;if(!q(e,t))return!1;const n=[];for(;t;){for(let o=0;o<t.children.length;o++){const i=t.children[o],a=t.leaf?this.toBBox(i):i;if(q(e,a)){if(t.leaf||et(e,a))return!0;n.push(i)}}t=n.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let n=0;n<e.length;n++)this.insert(e[n]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const n=this.data;this.data=t,t=n}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=X([]),this}remove(e,t){if(!e)return this;let n=this.data;const o=this.toBBox(e),i=[],a=[];let s,l,u;for(;n||i.length;){if(n||(n=i.pop(),l=i[i.length-1],s=a.pop(),u=!0),n.leaf){const c=Ze(e,n.children,t);if(c!==-1)return n.children.splice(c,1),i.push(n),this._condense(i),this}!u&&!n.leaf&&et(n,o)?(i.push(n),a.push(s),s=0,l=n,n=n.children[0]):l?(s++,n=l.children[s],u=!1):n=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,o){const i=n-t+1;let a=this._maxEntries,s;if(i<=a)return s=X(e.slice(t,n+1)),B(s,this.toBBox),s;o||(o=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,o-1))),s=X([]),s.leaf=!1,s.height=o;const l=Math.ceil(i/a),u=l*Math.ceil(Math.sqrt(a));Et(e,t,n,u,this.compareMinX);for(let c=t;c<=n;c+=u){const h=Math.min(c+u-1,n);Et(e,c,h,l,this.compareMinY);for(let p=c;p<=h;p+=l){const f=Math.min(p+l-1,h);s.children.push(this._build(e,p,f,o-1))}}return B(s,this.toBBox),s}_chooseSubtree(e,t,n,o){for(;o.push(t),!(t.leaf||o.length-1===n);){let i=1/0,a=1/0,s;for(let l=0;l<t.children.length;l++){const u=t.children[l],c=tt(u),h=en(e,u)-c;h<a?(a=h,i=c<i?c:i,s=u):h===a&&c<i&&(i=c,s=u)}t=s||t.children[0]}return t}_insert(e,t,n){const o=n?e:this.toBBox(e),i=[],a=this._chooseSubtree(o,this.data,t,i);for(a.children.push(e),b(a,o);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(o,i,t)}_split(e,t){const n=e[t],o=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,o);const a=this._chooseSplitIndex(n,i,o),s=X(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,B(n,this.toBBox),B(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)}_splitRoot(e,t){this.data=X([e,t]),this.data.height=e.height+1,this.data.leaf=!1,B(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let o,i=1/0,a=1/0;for(let s=t;s<=n-t;s++){const l=G(e,0,s,this.toBBox),u=G(e,s,n,this.toBBox),c=nn(l,u),h=tt(l)+tt(u);c<i?(i=c,o=s,a=h<a?h:a):c===i&&h<a&&(a=h,o=s)}return o||n-t}_chooseSplitAxis(e,t,n){const o=e.leaf?this.compareMinX:Je,i=e.leaf?this.compareMinY:tn,a=this._allDistMargin(e,t,n,o),s=this._allDistMargin(e,t,n,i);a<s&&e.children.sort(o)}_allDistMargin(e,t,n,o){e.children.sort(o);const i=this.toBBox,a=G(e,0,t,i),s=G(e,n-t,n,i);let l=U(a)+U(s);for(let u=t;u<n-t;u++){const c=e.children[u];b(a,e.leaf?i(c):c),l+=U(a)}for(let u=n-t-1;u>=t;u--){const c=e.children[u];b(s,e.leaf?i(c):c),l+=U(s)}return l}_adjustParentBBoxes(e,t,n){for(let o=n;o>=0;o--)b(t[o],e)}_condense(e){for(let t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():B(e[t],this.toBBox)}}function Ze(r,e,t){if(!t)return e.indexOf(r);for(let n=0;n<e.length;n++)if(t(r,e[n]))return n;return-1}function B(r,e){G(r,0,r.children.length,e,r)}function G(r,e,t,n,o){o||(o=X(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let i=e;i<t;i++){const a=r.children[i];b(o,r.leaf?n(a):a)}return o}function b(r,e){return r.minX=Math.min(r.minX,e.minX),r.minY=Math.min(r.minY,e.minY),r.maxX=Math.max(r.maxX,e.maxX),r.maxY=Math.max(r.maxY,e.maxY),r}function Je(r,e){return r.minX-e.minX}function tn(r,e){return r.minY-e.minY}function tt(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function U(r){return r.maxX-r.minX+(r.maxY-r.minY)}function en(r,e){return(Math.max(e.maxX,r.maxX)-Math.min(e.minX,r.minX))*(Math.max(e.maxY,r.maxY)-Math.min(e.minY,r.minY))}function nn(r,e){const t=Math.max(r.minX,e.minX),n=Math.max(r.minY,e.minY),o=Math.min(r.maxX,e.maxX),i=Math.min(r.maxY,e.maxY);return Math.max(0,o-t)*Math.max(0,i-n)}function et(r,e){return r.minX<=e.minX&&r.minY<=e.minY&&e.maxX<=r.maxX&&e.maxY<=r.maxY}function q(r,e){return e.minX<=r.maxX&&e.minY<=r.maxY&&e.maxX>=r.minX&&e.maxY>=r.minY}function X(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Et(r,e,t,n,o){const i=[e,t];for(;i.length;){if(t=i.pop(),e=i.pop(),t-e<=n)continue;const a=e+Math.ceil((t-e)/n/2)*n;Ke(r,a,e,t,o),i.push(e,a,a,t)}}var rn=function(){function r(e){this.rbush_=new We(e),this.items_={}}return r.prototype.insert=function(e,t){var n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(n),this.items_[R(t)]=n},r.prototype.load=function(e,t){for(var n=new Array(t.length),o=0,i=t.length;o<i;o++){var a=e[o],s=t[o],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:s};n[o]=l,this.items_[R(s)]=l}this.rbush_.load(n)},r.prototype.remove=function(e){var t=R(e),n=this.items_[t];return delete this.items_[t],this.rbush_.remove(n)!==null},r.prototype.update=function(e,t){var n=this.items_[R(t)],o=[n.minX,n.minY,n.maxX,n.maxY];Lt(o,e)||(this.remove(t),this.insert(e,t))},r.prototype.getAll=function(){var e=this.rbush_.all();return e.map(function(t){return t.value})},r.prototype.getInExtent=function(e){var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]},n=this.rbush_.search(t);return n.map(function(o){return o.value})},r.prototype.forEach=function(e){return this.forEach_(this.getAll(),e)},r.prototype.forEachInExtent=function(e,t){return this.forEach_(this.getInExtent(e),t)},r.prototype.forEach_=function(e,t){for(var n,o=0,i=e.length;o<i;o++)if(n=t(e[o]),n)return n;return n},r.prototype.isEmpty=function(){return ot(this.items_)},r.prototype.clear=function(){this.rbush_.clear(),this.items_={}},r.prototype.getExtent=function(e){var t=this.rbush_.toJSON();return Zt(t.minX,t.minY,t.maxX,t.maxY,e)},r.prototype.concat=function(e){this.rbush_.load(e.rbush_.all());for(var t in e.items_)this.items_[t]=e.items_[t]},r}(),Ct=rn,w={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function on(r,e){return[[-1/0,-1/0,1/0,1/0]]}var an=!1;function sn(r,e,t,n,o,i,a){var s=new XMLHttpRequest;s.open("GET",typeof r=="function"?r(t,n,o):r,!0),e.getType()=="arraybuffer"&&(s.responseType="arraybuffer"),s.withCredentials=an,s.onload=function(l){if(!s.status||s.status>=200&&s.status<300){var u=e.getType(),c=void 0;u=="json"||u=="text"?c=s.responseText:u=="xml"?(c=s.responseXML,c||(c=new DOMParser().parseFromString(s.responseText,"application/xml"))):u=="arraybuffer"&&(c=s.response),c?i(e.readFeatures(c,{extent:t,featureProjection:o}),e.readProjection(c)):a()}else a()},s.onerror=a,s.send()}function wt(r,e){return function(t,n,o,i,a){var s=this;sn(r,e,t,n,o,function(l,u){s.addFeatures(l),i!==void 0&&i(l)},a||Xt)}}var Gt=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),T=function(r){Gt(e,r);function e(t,n,o){var i=r.call(this,t)||this;return i.feature=n,i.features=o,i}return e}(kt),ln=function(r){Gt(e,r);function e(t){var n=this,o=t||{};n=r.call(this,{attributions:o.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:o.wrapX!==void 0?o.wrapX:!0})||this,n.on,n.once,n.un,n.loader_=Xt,n.format_=o.format,n.overlaps_=o.overlaps===void 0?!0:o.overlaps,n.url_=o.url,o.loader!==void 0?n.loader_=o.loader:n.url_!==void 0&&(W(n.format_,7),n.loader_=wt(n.url_,n.format_)),n.strategy_=o.strategy!==void 0?o.strategy:on;var i=o.useSpatialIndex!==void 0?o.useSpatialIndex:!0;n.featuresRtree_=i?new Ct:null,n.loadedExtentsRtree_=new Ct,n.loadingExtentsCount_=0,n.nullGeometryFeatures_={},n.idIndex_={},n.uidIndex_={},n.featureChangeKeys_={},n.featuresCollection_=null;var a,s;return Array.isArray(o.features)?s=o.features:o.features&&(a=o.features,s=a.getArray()),!i&&a===void 0&&(a=new Fe(s)),s!==void 0&&n.addFeaturesInternal(s),a!==void 0&&n.bindFeaturesCollection_(a),n}return e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var n=R(t);if(!this.addToIndex_(n,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(n,t);var o=t.getGeometry();if(o){var i=o.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,t)}else this.nullGeometryFeatures_[n]=t;this.dispatchEvent(new T(w.ADDFEATURE,t))},e.prototype.setupChangeEvents_=function(t,n){this.featureChangeKeys_[t]=[gt(n,_e.CHANGE,this.handleFeatureChange_,this),gt(n,ye.PROPERTYCHANGE,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,n){var o=!0,i=n.getId();return i!==void 0&&(i.toString()in this.idIndex_?o=!1:this.idIndex_[i.toString()]=n),o&&(W(!(t in this.uidIndex_),30),this.uidIndex_[t]=n),o},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var n=[],o=[],i=[],a=0,s=t.length;a<s;a++){var l=t[a],u=R(l);this.addToIndex_(u,l)&&o.push(l)}for(var a=0,c=o.length;a<c;a++){var l=o[a],u=R(l);this.setupChangeEvents_(u,l);var h=l.getGeometry();if(h){var p=h.getExtent();n.push(p),i.push(l)}else this.nullGeometryFeatures_[u]=l}if(this.featuresRtree_&&this.featuresRtree_.load(n,i),this.hasListener(w.ADDFEATURE))for(var a=0,f=o.length;a<f;a++)this.dispatchEvent(new T(w.ADDFEATURE,o[a]))},e.prototype.bindFeaturesCollection_=function(t){var n=!1;this.addEventListener(w.ADDFEATURE,function(o){n||(n=!0,t.push(o.feature),n=!1)}),this.addEventListener(w.REMOVEFEATURE,function(o){n||(n=!0,t.remove(o.feature),n=!1)}),t.addEventListener(P.ADD,function(o){n||(n=!0,this.addFeature(o.element),n=!1)}.bind(this)),t.addEventListener(P.REMOVE,function(o){n||(n=!0,this.removeFeature(o.element),n=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var n in this.featureChangeKeys_){var o=this.featureChangeKeys_[n];o.forEach(dt)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){var i=function(l){this.removeFeatureInternal(l)}.bind(this);this.featuresRtree_.forEach(i);for(var a in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[a])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var s=new T(w.CLEAR);this.dispatchEvent(s),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,n){var o=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(o,function(i){var a=i.getGeometry();if(a.intersectsCoordinate(t))return n(i)})},e.prototype.forEachFeatureInExtent=function(t,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)},e.prototype.forEachFeatureIntersectingExtent=function(t,n){return this.forEachFeatureInExtent(t,function(o){var i=o.getGeometry();if(i.intersectsExtent(t)){var a=n(o);if(a)return a}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),ot(this.nullGeometryFeatures_)||H(t,me(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var n=[];return this.forEachFeatureAtCoordinateDirect(t,function(o){n.push(o)}),n},e.prototype.getFeaturesInExtent=function(t,n){var o=this;if(this.featuresRtree_){var i=n&&n.canWrapX()&&this.getWrapX();if(!i)return this.featuresRtree_.getInExtent(t);var a=Jt(t,n);return[].concat.apply([],a.map(function(s){return o.featuresRtree_.getInExtent(s)}))}else return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]},e.prototype.getClosestFeatureToCoordinate=function(t,n){var o=t[0],i=t[1],a=null,s=[NaN,NaN],l=1/0,u=[-1/0,-1/0,1/0,1/0],c=n||Ee;return this.featuresRtree_.forEachInExtent(u,function(h){if(c(h)){var p=h.getGeometry(),f=l;if(l=p.closestPointXY(o,i,s,l),l<f){a=h;var g=Math.sqrt(l);u[0]=o-g,u[1]=i-g,u[2]=o+g,u[3]=i+g}}}),a},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var n=this.idIndex_[t.toString()];return n!==void 0?n:null},e.prototype.getFeatureByUid=function(t){var n=this.uidIndex_[t];return n!==void 0?n:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var n=t.target,o=R(n),i=n.getGeometry();if(!i)o in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[o]=n);else{var a=i.getExtent();o in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[o],this.featuresRtree_&&this.featuresRtree_.insert(a,n)):this.featuresRtree_&&this.featuresRtree_.update(a,n)}var s=n.getId();if(s!==void 0){var l=s.toString();this.idIndex_[l]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[l]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[o]=n;this.changed(),this.dispatchEvent(new T(w.CHANGEFEATURE,n))},e.prototype.hasFeature=function(t){var n=t.getId();return n!==void 0?n in this.idIndex_:R(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&ot(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0},e.prototype.loadFeatures=function(t,n,o){for(var i=this.loadedExtentsRtree_,a=this.strategy_(t,n,o),s=function(h,p){var f=a[h],g=i.forEachInExtent(f,function(_){return te(_.extent,f)});g||(++l.loadingExtentsCount_,l.dispatchEvent(new T(w.FEATURESLOADSTART)),l.loader_.call(l,f,n,o,function(_){--this.loadingExtentsCount_,this.dispatchEvent(new T(w.FEATURESLOADEND,void 0,_))}.bind(l),function(){--this.loadingExtentsCount_,this.dispatchEvent(new T(w.FEATURESLOADERROR))}.bind(l)),i.insert(f,{extent:f.slice()}))},l=this,u=0,c=a.length;u<c;++u)s(u);this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),r.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var n=this.loadedExtentsRtree_,o;n.forEachInExtent(t,function(i){if(Lt(i.extent,t))return o=i,!0}),o&&n.remove(o)},e.prototype.removeFeature=function(t){if(!!t){var n=R(t);n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(t);var o=this.removeFeatureInternal(t);o&&this.changed()}},e.prototype.removeFeatureInternal=function(t){var n=R(t),o=this.featureChangeKeys_[n];if(!!o){o.forEach(dt),delete this.featureChangeKeys_[n];var i=t.getId();return i!==void 0&&delete this.idIndex_[i.toString()],delete this.uidIndex_[n],this.dispatchEvent(new T(w.REMOVEFEATURE,t)),t}},e.prototype.removeFromIdIndex_=function(t){var n=!1;for(var o in this.idIndex_)if(this.idIndex_[o]===t){delete this.idIndex_[o],n=!0;break}return n},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){W(this.format_,7),this.url_=t,this.setLoader(wt(t,this.format_))},e}(xe),un=ln;const cn={name:"PageFullScreen",methods:{tweak(){return{height:this.$q.screen.height-50+"px"}},myTweak(r){r||(r=0);const e=this.$q.platform.is.cordova?`calc(100vh - ${r}px)`:window.innerHeight-r+"px";return this.$store.state.windowSize=e,{minHeight:e}}}};function hn(r,e,t,n,o,i){return C(),A(Re,{"style-fn":i.tweak,class:"scroll-y fhpadd"},{default:y(()=>[ee(r.$slots,"default")]),_:3},8,["style-fn"])}var fn=Y(cn,[["render",hn]]);const K=ne("location",{state:()=>({foregroundLocationActivated:!1,isCordova:re.is.cordova,projection:null,rotation:45,watchId:null,locationTracking:!1,navigationActive:!1,myLocation:{},myTrack:[],navigateTo:[]}),getters:{getProjection(r){return r.projection},getRotation(r){return r.rotation},getLocationTracking(r){return r.locationTracking},getNavigationActive(r){return r.navigationActive},getMyLocation(r){return r.myLocation},getMyLocationAccuracy(r){return r.myLocation.accuracy},getMyLocationCoordinates(r){return r.myLocation.coordinates},getMyTrack(r){return r.myTrack},getNavigateTo(r){return r.navigateTo},foregroundNotNeeded(r){return!r.locationTracking&&!r.navigationActive}},actions:{initialize(r){this.projection=r,this.watchId&&navigator.compass.clearWatch(this.watchId),this.isCordova&&(window.BackgroundGeolocation.configure({locationProvider:window.BackgroundGeolocation.DISTANCE_FILTER_PROVIDER,desiredAccuracy:window.BackgroundGeolocation.MEDIUM_ACCURACY,stationaryRadius:10,distanceFilter:10,stopOnTerminate:!1,debug:!0,startForeground:!0,notificationsEnabled:!0,httpHeaders:{"X-Auth":"\u010De ga rabi\u0161"},interval:5e3,fastestInterval:2e3,activitiesInterval:1e3}),window.BackgroundGeolocation.on("authorization",e=>{e!==window.BackgroundGeolocation.AUTHORIZED&&setTimeout(()=>{navigator.notification.confirm("Please enable location access",t=>{t===1&&window.BackgroundGeolocation.showAppSettings()},"Kataster jam")},1e3)}),window.BackgroundGeolocation.on("location",e=>{this.newLocationUpdate(e)}),this.watchId=navigator.compass.watchHeading(e=>{this.rotation=e.magneticHeading},e=>{alert("Compass error: "+e.code)},{frequency:1e3})),navigator.geolocation.watchPosition(e=>{this.foregroundLocationActivated&&e.coords.accuracy>10&&this.isCordova||this.newLocationUpdate(e.coords)},(e,t)=>{console.error("Error when trying to fetch location",e,t)},{enableHighAccuracy:!0})},newLocationUpdate(r){const e=It([r.longitude,r.latitude]);this.myLocation={coordinates:e,accuracy:r.accuracy,latitude:r.latitude,longitude:r.longitude},this.getLocationTracking&&this.updateMyTrack(e),this.getNavigationActive&&this.updateNavigation(e)},toggleLocationTracking(){this.locationTracking=!this.locationTracking,this.locationTracking&&this.isCordova&&window.BackgroundGeolocation.configure({notificationTitle:"Location tracking",notificationText:"Tracking your location is in progress"}),this.locationTracking?this.startForeground():this.stopForeground()},stopNavigation(){this.navigationActive=!1,this.stopForeground(),this.updateNavigation([])},startNavigation(r){this.goTo=r,this.navigateTo.length===2&&(this.navigateTo[0]=this.goTo.getGeometry().getCoordinates()),this.isCordova&&window.BackgroundGeolocation.configure({notificationTitle:"Navigation",notificationText:"Navigation to a location is in progress"}),this.navigationActive=!0,this.startForeground()},startForeground(){this.foregroundLocationActivated||(this.isCordova&&window.BackgroundGeolocation.start(),this.foregroundLocationActivated=!0)},stopForeground(){this.foregroundLocationActivated&&this.foregroundNotNeeded&&(this.isCordova&&window.BackgroundGeolocation.stop(),this.foregroundLocationActivated=!1)},updateMyTrack(r){this.myTrack.push(r)},updateNavigation(r){this.navigateTo=r.length===0?[]:[this.goTo.getGeometry().getCoordinates(),r]}}}),pn={setup(){const r=K(),e=x(5),t=x("red");return{store:r,strokeWidth:e,strokeColor:t}},computed:{myTrack(){return this.store.getMyTrack}}};function gn(r,e,t,n,o,i){const a=v("ol-geom-line-string"),s=v("ol-style-stroke"),l=v("ol-style"),u=v("ol-feature"),c=v("ol-source-vector"),h=v("ol-vector-layer");return C(),A(h,null,{default:y(()=>[d(c,null,{default:y(()=>[d(u,null,{default:y(()=>[d(a,{coordinates:i.myTrack},null,8,["coordinates"]),d(l,null,{default:y(()=>[d(s,{color:n.strokeColor,width:n.strokeWidth},null,8,["color","width"])]),_:1})]),_:1})]),_:1})]),_:1})}var dn=Y(pn,[["render",gn]]);const vn=nt("div",{class:"q-space"});var _n=Rt({name:"QSpace",setup(){return()=>vn}});const yn={setup(){const r=x(!0),e=x("top"),t=K(),n=x(3),o=x("green");return{dialog:r,position:e,store:t,strokeWidth:n,strokeColor:o}},data(){return{currentCenter:this.center,currentZoom:this.zoom,currentResolution:this.resolution,fixedCenter:!1,name:this.$route.query.name}},computed:{bearing(){return(([t,n],[o,i])=>{const a=o-t,s=i-n;return(Math.atan2(a,s)*180/Math.PI+360)%360})(this.store.getNavigateTo[1],this.store.getNavigateTo[0])-this.store.getRotation},navigateTo(){return this.store.getNavigateTo},navigationInProgress(){return this.store.getNavigateTo.length>0},distance(){const r=new xt(this.store.getNavigateTo),e=pt(r);return e>1e3?(e/1e3).toFixed(2):parseInt(e)},distanceUnit(){const r=new xt(this.store.getNavigateTo);return pt(r)>1e3?"km":"m"}},methods:{stopNavigation(){this.store.stopNavigation()}}},mn={class:"text-weight-bold"},xn={class:"text-grey"};function En(r,e,t,n,o,i){const a=v("ol-geom-line-string"),s=v("ol-style-stroke"),l=v("ol-style"),u=v("ol-feature"),c=v("ol-source-vector"),h=v("ol-vector-layer");return C(),V(Q,null,[d(ae,{modelValue:i.navigationInProgress,"onUpdate:modelValue":e[0]||(e[0]=p=>i.navigationInProgress=p),position:n.position,seamless:"",class:"q-dialog__top50"},{default:y(()=>[d(oe,{style:{width:"350px"}},{default:y(()=>[d(ie,{class:"row items-center no-wrap"},{default:y(()=>[Z("div",null,[Z("div",mn,$(r.$t("goTo"))+": "+$(o.name),1),Z("div",xn,$(r.$t("distance"))+": "+$(i.distance)+" "+$(i.distanceUnit),1)]),d(_n),d(Tt,{name:"navigation",style:At({rotate:i.bearing+"deg"}),size:"lg"},null,8,["style"]),d(rt,{flat:"",round:"",icon:"stop",onClick:i.stopNavigation},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","position"]),d(h,null,{default:y(()=>[d(c,null,{default:y(()=>[d(u,null,{default:y(()=>[d(a,{coordinates:i.navigateTo},null,8,["coordinates"]),d(l,null,{default:y(()=>[d(s,{color:n.strokeColor,width:n.strokeWidth},null,8,["color","width"])]),_:1})]),_:1})]),_:1})]),_:1})],64)}var Cn=Y(yn,[["render",En]]);const wn={props:["view"],emits:["centerChanged"],components:{TrackingLayer:dn,NavigationLayer:Cn},setup(){const r=K(),e=x([]),t=x([]),{myLocation:n}=se(r);return{store:r,myLocationCoordinates:e,myLocationFeatures:t,myLocation:n}},computed:{rotation(){return this.store.getRotation}},watch:{myLocation(r,e){const t=Ue([r.longitude,r.latitude],this.store.getMyLocationAccuracy);this.myLocationFeatures=[new it(t.transform("EPSG:4326",this.store.getProjection)),new it(new ut(this.store.getMyLocationCoordinates))],this.myLocationCoordinates=r.coordinates,this.$emit("centerChanged",this.store.getMyLocationCoordinates)}}};function Rn(r,e,t,n,o,i){const a=v("ol-source-vector"),s=v("ol-vector-layer"),l=v("ol-overlay"),u=v("TrackingLayer"),c=v("NavigationLayer");return C(),V(Q,null,[d(s,null,{default:y(()=>[d(a,{features:n.myLocationFeatures},null,8,["features"])]),_:1}),n.myLocationFeatures.length>0?(C(),A(l,{key:0,position:n.myLocationCoordinates,positioning:"center-center"},{default:y(h=>[d(Tt,{name:"navigation",class:le(h),style:At({rotate:i.rotation+"deg"}),size:"lg"},null,8,["class","style"])]),_:1},8,["position"])):Ft("",!0),d(u),d(c)],64)}var Ln=Y(wn,[["render",Rn]]);const In={setup(){const r=Le(),e=x([]),t=x(new un);return r.loadForMap().then(()=>{console.log("locations loaded"),r.customLocationsForMap.map(n=>e.value.push(n))}),{vectorSource:t,store:r,customLocations:e}}};function Tn(r,e,t,n,o,i){const a=v("ol-geom-point"),s=v("ol-style-icon"),l=v("ol-style"),u=v("ol-feature"),c=v("ol-source-vector"),h=v("ol-vector-layer");return C(),A(h,null,{default:y(()=>[d(c,{ref:"vectorSource"},{default:y(()=>[(C(!0),V(Q,null,Mt(n.customLocations,p=>(C(),A(u,{key:p.id,properties:{id:p.id,name:p.name}},{default:y(()=>[d(a,{coordinates:p.latLng},null,8,["coordinates"]),d(l,null,{default:y(()=>[d(s,{src:p.icon,scale:1},null,8,["src"])]),_:2},1024)]),_:2},1032,["properties"]))),128))]),_:1},512)]),_:1})}var An=Y(In,[["render",Tn]]);const Fn=ue({name:"IndexPage",components:{PageFullScreen:fn,CartoLayers:Ce,LocationLayers:Ln,CustomLocationLayers:An},setup(){const r=K(),e=we(),t=x([1637531,5766419]),n=x("EPSG:3857"),o=x(8),i=x(!1),a=x([]),s=x(null),l=x(""),u=x("");return{store:r,center:t,projection:n,zoom:o,view:l,mapRef:u,markLocations:a,goTo:s,customLocations:i,mapStore:e}},data(){if(this.$route.query.lat&&this.$route.query.lng){const r=It([this.$route.query.lng,this.$route.query.lat]),e=new it(new ut(r));this.markLocations=[e],this.center=r,this.zoom=15,this.goTo=this.$route.query.navigate?e:null}return this.customLocations=this.$route.query.customLocation,{currentCenter:this.center,currentZoom:this.zoom,currentResolution:this.resolution,fixedCenter:!1}},computed:{trackLocationIcon(){return this.store.getLocationTracking},navigationActive(){return this.store.getNavigationActive},isCenterFixed(){return this.fixedCenter}},methods:{zoomChanged(r){this.currentZoom=r},trackingClicked(r){this.store.toggleLocationTracking()},myLocationClicked(r){this.center=this.store.getMyLocationCoordinates,this.fixedCenter=!0,this.zoom=this.zoom<15?15:this.currentZoom},resolutionChanged(r){this.currentResolution=r},centerChanged(r){this.view!==""&&(this.currentCenter=r,this.view.getInteracting()?this.fixedCenter=!1:this.fixedCenter&&(this.center=r))},onScreenOrientationChange(){this.mapRef.updateSize()}},watch:{view(r,e){this.store.initialize(r.getProjection()),this.goTo&&this.store.startNavigation(this.goTo)}}});function Mn(r,e,t,n,o,i){const a=v("ol-view"),s=v("CartoLayers"),l=v("LocationLayers"),u=v("CustomLocationLayers"),c=v("ol-source-vector"),h=v("ol-vector-layer"),p=v("ol-map"),f=v("PageFullScreen");return C(),A(f,{style:{background:"#eee"}},{default:y(()=>[d(p,{loadTilesWhileAnimating:"",loadTilesWhileInteracting:"",style:{height:"100%"},ref:"mapRef"},{default:y(()=>[d(a,{ref:"view",enableRotation:!1,center:r.center,zoom:r.zoom,projection:r.projection,onZoomChanged:r.zoomChanged,onCenterChanged:r.centerChanged,onResolutionChanged:r.resolutionChanged},null,8,["center","zoom","projection","onZoomChanged","onCenterChanged","onResolutionChanged"]),d(s),d(l,{view:r.view,onCenterChanged:r.centerChanged},null,8,["view","onCenterChanged"]),r.customLocations?(C(),A(u,{key:0})):Ft("",!0),d(h,null,{default:y(()=>[d(c,{features:r.markLocations},null,8,["features"])]),_:1}),d(bt,{onResize:r.onScreenOrientationChange},null,8,["onResize"])]),_:1},512),d(J,{position:"top-right",offset:[18,18]},{default:y(()=>[d(Dt,{size:"100px","external-label":"",color:"purple",icon:"layers",direction:"left"},{default:y(()=>[(C(!0),V(Q,null,Mt(r.mapStore.getLayers,g=>(C(),A(Ut,{key:g.name,padding:"3px","label-class":"bg-grey-3 text-grey-8","external-label":"","label-position":"bottom",color:g.active?"red":"primary",onClick:_=>g.active=!g.active,icon:`img:${g.preview}`,label:g.label},null,8,["color","onClick","icon","label"]))),128))]),_:1})]),_:1}),d(J,{position:"bottom-left",offset:[18,18]},{default:y(()=>[d(rt,{fab:"",icon:r.isCenterFixed?"my_location":"location_searching",color:"accent",onClick:r.myLocationClicked},null,8,["icon","onClick"])]),_:1}),d(J,{position:"bottom-right",offset:[18,18]},{default:y(()=>[d(rt,{fab:"",icon:r.trackLocationIcon?"stop_circle":"play_arrow",color:"accent",onClick:r.trackingClicked},null,8,["icon","onClick"])]),_:1})]),_:1})}var Nn=Y(Fn,[["render",Mn]]);export{Nn as default};
