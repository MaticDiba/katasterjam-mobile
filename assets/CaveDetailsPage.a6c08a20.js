import{Q as L,a as b,b as Q}from"./QMarkupTable.f6e561d9.js";import{_ as I,r,aC as x,ag as f,j as n,H as $,I as c,Q as z,d as s,K as t,L as e,ah as M,M as O,aF as P,k as v,aB as k,F as C,J as S,m as j}from"./index.fca8318d.js";import{u as q}from"./use-quasar.0e972b11.js";import{f as B}from"./proj.d12bfe9d.js";import{C as E,F as V,P as R}from"./CartoLayers.d6cba2d3.js";import{f as A}from"./date.3d23ecb2.js";const W={name:"CaveDetailsPage",components:{CartoLayers:E},setup(){const{dialog:a}=q(),l=r([1637531,5766419]),d=r("EPSG:3857"),o=r(15),w=r([]),i=r(""),_=r(null),m=r(null);return{confirmDialog:a,center:l,projection:d,zoom:o,view:i,confirm:r(!1),markLocations:w,cave:_,confirmRef:m,formatDate:A}},computed:{favouriteIcon(){return this.cave.isFavourite?"favorite":"favorite_border"},selectedName(){var a,l;return`[${(a=this.cave)==null?void 0:a.caveNumber}] ${(l=this.cave)==null?void 0:l.name}`}},methods:{goTo(){var l,d;this.confirm=!0;const a=`[${(l=this.cave)==null?void 0:l.caveNumber}] ${(d=this.cave)==null?void 0:d.name}`;this.confirmDialog({title:`${this.$t("confirm")}`,message:`${this.$t("navigateToCave")}: ${a}`,cancel:!0,persistent:!0}).onOk(()=>{this.$router.push({path:"/",query:{lat:this.cave.lat,lng:this.cave.lng,navigate:!0,name:a}})})},showOnMap(){this.$router.push({path:"/",query:{lat:this.cave.lat,lng:this.cave.lng}})},navigateToSelectedCave(){this.$router.push({path:"/",query:{lat:this.cave.lat,lng:this.cave.lng,navigate:!0,name:`${this.cave.caveNumber} - ${this.cave.name}`}})},async toggleFavourite(){if(this.cave.isFavourite)try{await x.delete("/api/favorites/",{data:{caveId:this.cave.caveNumber}}),this.cave.isFavourite=!1}catch(a){console.error(a)}else try{await x.post("/api/favorites",{caveId:this.cave.caveNumber}),this.cave.isFavourite=!0}catch(a){console.error(a)}}},created(){this.cave=this.$route.meta.cave;const a=B([this.cave.lng,this.cave.lat]);this.center=a;const l=new V(new R(a));this.markLocations=[l]}},Y={class:"text-overline text-orange-9"},G={class:"row no-wrap items-center"},H={class:"col text-h6 ellipsis"},J={class:"col-auto text-grey text-caption q-pt-md row no-wrap items-center"},K={class:"row no-wrap items-center"},U={class:"col-auto text-grey text-caption q-pt-md row no-wrap items-center"},X={class:"text-left table-row-fit"},Z={class:"text-left table-row-fit"},tt={key:0},et={class:"text-left table-row-fit"},at={class:"text-left table-row-fit"},ot={class:"text-left table-row-fit"},st={class:"text-left table-row-fit"},lt={class:"text-left table-row-fit"},rt={class:"text-left table-row-fit"},it={class:"text-left table-row-fit"},nt={class:"text-left table-row-fit"},ct={class:"text-left table-row-fit"},dt={class:"text-left table-row-fit"},ft={class:"text-left table-row-fit"},vt={class:"text-left table-row-fit"},ht={class:"text-left table-row-fit"},_t={class:"text-left table-row-fit"},mt={class:"text-left table-row-fit"},ut={class:"text-left table-row-fit"},bt={class:"text-left table-row-fit"},wt={class:"text-left table-row-fit"},gt={class:"text-left table-row-fit"},pt={class:"text-left table-row-fit"},yt={class:"text-left table-row-fit"},xt={class:"text-left table-row-fit"},kt={class:"text-left table-row-fit"},Ct={class:"text-left table-row-fit"},Ft={class:"text-left table-row-fit"},Dt={class:"text-left table-row-fit"};function Nt(a,l,d,o,w,i){const _=f("ol-view"),m=f("CartoLayers"),F=f("ol-source-vector"),D=f("ol-vector-layer"),N=f("ol-map");return n(),$(z,{class:"cave-top"},{default:c(()=>[s(N,{loadTilesWhileAnimating:"",loadTilesWhileInteracting:"",style:{height:"200px"}},{default:c(()=>[s(_,{ref:"view",enableRotation:!1,center:o.center,zoom:o.zoom,projection:o.projection},null,8,["center","zoom","projection"]),s(m),s(D,null,{default:c(()=>[s(F,{features:o.markLocations},null,8,["features"])]),_:1})]),_:1}),s(O,null,{default:c(()=>[s(L,{class:"absolute",style:{top:"0",right:"12px",transform:"translateY(-50%)"},"vertical-actions-align":"right",color:"primary",glossy:"",icon:"keyboard_arrow_up",direction:"up"},{default:c(()=>[s(b,{"label-position":"left",color:"green",icon:"map",label:a.$t("mainMap"),onClick:i.showOnMap},null,8,["label","onClick"]),s(b,{"label-position":"left",color:"red",icon:i.favouriteIcon,label:a.$t("favourite"),onClick:i.toggleFavourite},null,8,["icon","label","onClick"]),s(b,{"label-position":"left",color:"orange",icon:"assist_walker",label:a.$t("navigate"),onClick:i.goTo},null,8,["label","onClick"])]),_:1}),t("div",Y,e(a.$t("caveDetails")),1),t("div",G,[t("div",H,e(o.cave.caveNumber)+" - "+e(o.cave.name),1),t("div",J,[s(M,{name:i.favouriteIcon,color:o.cave.isFavourite?"red":"default",size:"sm"},null,8,["name","color"])])]),t("div",K,[t("div",U,e(a.$t("length"))+": "+e(o.cave.length)+" m, "+e(a.$t("depth"))+": "+e(o.cave.depth)+" m ",1)])]),_:1}),s(P),s(Q,null,{default:c(()=>{var g,p,y;return[t("tbody",null,[t("tr",null,[t("td",X,e(a.$t("organizations")),1),t("td",Z,[(n(!0),v(C,null,k(o.cave.organizations,(h,u)=>(n(),v("span",{key:h.id},[S(e(h.name),1),u+1<o.cave.organizations.length?(n(),v("span",tt,", ")):j("",!0)]))),128))])]),t("tr",null,[t("td",et,e(a.$t("dateOfDiscovery")),1),t("td",at,e(o.formatDate(o.cave.dateOfExcursion)),1)]),t("tr",null,[t("td",ot,e(a.$t("authorsOfReport")),1),t("td",st,e(o.cave.author),1)]),t("tr",null,[t("td",lt,e(a.$t("discoverers")),1),t("td",rt,e(o.cave.team),1)]),t("tr",null,[t("td",it,e(a.$t("importDate")),1),t("td",nt,e(o.formatDate(o.cave.dateOfSubmission)),1)]),t("tr",null,[t("td",ct,e(a.$t("note")),1),t("td",dt,e(o.cave.notes),1)]),t("tr",null,[t("td",ft,e(a.$t("showCave")),1),t("td",vt,e(o.cave.turisticCave?"Yes":"No"),1)]),t("tr",null,[t("td",ht,e(a.$t("type")),1),t("td",_t,[(n(!0),v(C,null,k(o.cave.caveTypes,({name:h,description:u},T)=>(n(),v("span",{key:T},e(h)+" - "+e(a.$t(`caveTypes.${u}`)),1))),128))])]),t("tr",null,[t("td",mt,e(a.$t("dk48")),1),t("td",ut,e(o.cave.xcoordinate)+", "+e(o.cave.ycoordinate),1)]),t("tr",null,[t("td",bt,e(a.$t("wgs84")),1),t("td",wt,e(o.cave.lng.toFixed(5))+", "+e(o.cave.lat.toFixed(5)),1)]),t("tr",null,[t("td",gt,e(a.$t("entranceElevation")),1),t("td",pt,e(o.cave.entranceElevation)+" m",1)]),t("tr",null,[t("td",yt,e(a.$t("closestTown")),1),t("td",xt,e((g=o.cave.settlement)==null?void 0:g.name),1)]),t("tr",null,[t("td",kt,e(a.$t("municipality")),1),t("td",Ct,e((p=o.cave.settlement)==null?void 0:p.municipality),1)]),t("tr",null,[t("td",Ft,e(a.$t("kadasterMunicipality")),1),t("td",Dt,e((y=o.cave.kadasterMunicipality)==null?void 0:y.name),1)])])]}),_:1})]),_:1})}var Mt=I(W,[["render",Nt]]);export{Mt as default};
