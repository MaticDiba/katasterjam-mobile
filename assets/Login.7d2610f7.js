import{Q as M,a as D,b as E,c as R,d as j}from"./QLayout.93c70b74.js";import{s as k,r as B,p as O,u as K,v as U,o as J,h as o,x as X,g as A,y as Y,z as V,A as G,B as W,C as Z,D as ee,E as te,c,G as H,H as ae,I as oe,J as re,K as le,_ as se,L as ne,M as ie,N as ue,j as N,O as I,P as u,d as n,Q as L,R as h,S as w,U as ce,V as $,W as T,X as de,Y as fe,m as ge}from"./index.56610da6.js";import{Q as me}from"./QPage.ab8fdb7a.js";import{u as ve}from"./use-quasar.f86621e6.js";import"./QResizeObserver.8a3a2ec8.js";var he=k({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:a,emit:l}){const d=A(),r=B(null);let f=0;const i=[];function p(t){const m=typeof t=="boolean"?t:e.noErrorFocus!==!0,_=++f,S=(s,g)=>{l("validation"+(s===!0?"Success":"Error"),g)},Q=s=>{const g=s.validate();return typeof g.then=="function"?g.then(v=>({valid:v,comp:s}),v=>({valid:!1,comp:s,err:v})):Promise.resolve({valid:g,comp:s})};return(e.greedy===!0?Promise.all(i.map(Q)).then(s=>s.filter(g=>g.valid!==!0)):i.reduce((s,g)=>s.then(()=>Q(g).then(v=>{if(v.valid===!1)return Promise.reject(v)})),Promise.resolve()).catch(s=>[s])).then(s=>{if(s===void 0||s.length===0)return _===f&&S(!0),!0;if(_===f){const{comp:g,err:v}=s[0];if(v!==void 0&&console.error(v),S(!1,g),m===!0){const P=s.find(({comp:F})=>typeof F.focus=="function"&&Y(F.$)===!1);P!==void 0&&P.comp.focus()}}return!1})}function x(){f++,i.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function q(t){t!==void 0&&V(t);const m=f+1;p().then(_=>{m===f&&_===!0&&(e.onSubmit!==void 0?l("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function b(t){t!==void 0&&V(t),l("reset"),G(()=>{x(),e.autofocus===!0&&e.noResetFocus!==!0&&y()})}function y(){W(()=>{if(r.value===null)return;const t=r.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(r.value.querySelectorAll("[tabindex]"),m=>m.tabIndex>-1);t!=null&&t.focus({preventScroll:!0})})}O(Z,{bindComponent(t){i.push(t)},unbindComponent(t){const m=i.indexOf(t);m>-1&&i.splice(m,1)}});let C=!1;return K(()=>{C=!0}),U(()=>{C===!0&&e.autofocus===!0&&y()}),J(()=>{e.autofocus===!0&&y()}),Object.assign(d.proxy,{validate:p,resetValidation:x,submit:q,reset:b,focus:y,getValidationComponents:()=>i}),()=>o("form",{class:"q-form",ref:r,onSubmit:q,onReset:b},X(a.default))}});const be=[o("g",[o("path",{fill:"none",stroke:"currentColor","stroke-width":"5","stroke-miterlimit":"10",d:"M58.4,51.7c-0.9-0.9-1.4-2-1.4-2.3s0.5-0.4,1.4-1.4 C70.8,43.8,79.8,30.5,80,15.5H70H30H20c0.2,15,9.2,28.1,21.6,32.3c0.9,0.9,1.4,1.2,1.4,1.5s-0.5,1.6-1.4,2.5 C29.2,56.1,20.2,69.5,20,85.5h10h40h10C79.8,69.5,70.8,55.9,58.4,51.7z"}),o("clipPath",{id:"uil-hourglass-clip1"},[o("rect",{x:"15",y:"20",width:" 70",height:"25"},[o("animate",{attributeName:"height",from:"25",to:"0",dur:"1s",repeatCount:"indefinite",values:"25;0;0",keyTimes:"0;0.5;1"}),o("animate",{attributeName:"y",from:"20",to:"45",dur:"1s",repeatCount:"indefinite",values:"20;45;45",keyTimes:"0;0.5;1"})])]),o("clipPath",{id:"uil-hourglass-clip2"},[o("rect",{x:"15",y:"55",width:" 70",height:"25"},[o("animate",{attributeName:"height",from:"0",to:"25",dur:"1s",repeatCount:"indefinite",values:"0;25;25",keyTimes:"0;0.5;1"}),o("animate",{attributeName:"y",from:"80",to:"55",dur:"1s",repeatCount:"indefinite",values:"80;55;55",keyTimes:"0;0.5;1"})])]),o("path",{d:"M29,23c3.1,11.4,11.3,19.5,21,19.5S67.9,34.4,71,23H29z","clip-path":"url(#uil-hourglass-clip1)",fill:"currentColor"}),o("path",{d:"M71.6,78c-3-11.6-11.5-20-21.5-20s-18.5,8.4-21.5,20H71.6z","clip-path":"url(#uil-hourglass-clip2)",fill:"currentColor"}),o("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"180 50 50",repeatCount:"indefinite",dur:"1s",values:"0 50 50;0 50 50;180 50 50",keyTimes:"0;0.7;1"})])];var ye=k({name:"QSpinnerHourglass",props:ee,setup(e){const{cSize:a,classes:l}=te(e);return()=>o("svg",{class:l.value,width:a.value,height:a.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},be)}});const _e=["top","middle","bottom"];var Se=k({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>_e.includes(e)}},setup(e,{slots:a}){const l=c(()=>e.align!==void 0?{verticalAlign:e.align}:null),d=c(()=>{const r=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(r!==void 0?` text-${r}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>o("div",{class:d.value,style:l.value,role:"status","aria-label":e.label},H(a.default,e.label!==void 0?[e.label]:[]))}});const pe={xs:2,sm:4,md:6,lg:10,xl:14};function z(e,a,l){return{transform:a===!0?`translateX(${l.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}var xe=k({name:"QLinearProgress",props:{...ae,...oe,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:a}){const{proxy:l}=A(),d=re(e,l.$q),r=le(e,pe),f=c(()=>e.indeterminate===!0||e.query===!0),i=c(()=>e.reverse!==e.query),p=c(()=>({...r.value!==null?r.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),x=c(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),q=c(()=>z(e.buffer!==void 0?e.buffer:1,i.value,l.$q)),b=c(()=>`with${e.instantFeedback===!0?"out":""}-transition`),y=c(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${b.value} q-linear-progress__track--${d.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),C=c(()=>z(f.value===!0?1:e.value,i.value,l.$q)),t=c(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${b.value} q-linear-progress__model--${f.value===!0?"in":""}determinate`),m=c(()=>({width:`${e.value*100}%`})),_=c(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${b.value}`);return()=>{const S=[o("div",{class:y.value,style:q.value}),o("div",{class:t.value,style:C.value})];return e.stripe===!0&&f.value===!1&&S.push(o("div",{class:_.value,style:m.value})),o("div",{class:x.value,style:p.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},H(a.default,S))}}});const qe={name:"LoginPage",setup(){const e=ne(),a=ie(),l=B(0),{getPageNumber:d}=ue(a),{notify:r}=ve();return{notify:r,loggingIn:B(!1),store:e,cavesStore:a,progress:l,progressLabel:c(()=>(l.value*100).toFixed(2)+"%"),getPageNumber:d}},data(){return{account:{email:"",password:""}}},watch:{getPageNumber(e,a){this.progress=e/this.cavesStore.totalPages}},methods:{async submitForm(){this.loggingIn=!0;try{const e={email:this.account.email,password:this.account.password,rememberMe:!0},a=await this.store.login(e);a.success?(await this.cavesStore.tryFetchCavesForOffline(),this.$router.replace("/")):console.error(a.message[0])}catch(e){console.error(e),this.notify({message:this.$t("loginFailed"),color:"red"})}finally{this.loggingIn=!1}}}},Ce={class:"column"},we={class:"row"},ke={class:"text-h5 text-white q-my-md"},$e={class:"row"},Be={class:"text-grey-6"},Qe={class:"text-grey-6"},Pe={class:"absolute-full flex flex-center"};function Fe(e,a,l,d,r,f){return N(),I(M,{view:"lHh Lpr lFf"},{default:u(()=>[n(R,{elevated:""},{default:u(()=>[n(D,null,{default:u(()=>[n(E,null,{default:u(()=>[L(" eKatasterJam ")]),_:1})]),_:1})]),_:1}),n(j,null,{default:u(()=>[n(me,{class:"bg-light-blue row justify-center items-center"},{default:u(()=>[h("div",Ce,[h("div",we,[h("h5",ke,w(e.$t("logIn")),1)]),h("div",$e,[n(ce,{bordered:"",class:"q-pa-lg shadow-1"},{default:u(()=>[n($,null,{default:u(()=>[n(he,{class:"q-gutter-md"},{default:u(()=>[n(T,{square:"",filled:"",clearable:"",modelValue:r.account.email,"onUpdate:modelValue":a[0]||(a[0]=i=>r.account.email=i),type:"email",label:e.$t("email")},null,8,["modelValue","label"]),n(T,{square:"",filled:"",clearable:"",modelValue:r.account.password,"onUpdate:modelValue":a[1]||(a[1]=i=>r.account.password=i),type:"password",label:e.$t("password")},null,8,["modelValue","label"])]),_:1})]),_:1}),n(de,{class:"q-px-md"},{default:u(()=>[n(fe,{disable:d.loggingIn,loading:d.loggingIn,unelevated:"",color:"light-blue-7",size:"lg",class:"full-width",label:e.$t("loginLabel"),onClick:f.submitForm,type:"submit"},{loading:u(()=>[n(ye,{class:"on-right"}),L(" "+w(e.$t("loggingIn")),1)]),_:1},8,["disable","loading","label","onClick"])]),_:1}),n($,{class:"text-center q-pa-none"},{default:u(()=>[h("p",Be,w(e.$t("register")),1)]),_:1}),d.loggingIn?(N(),I($,{key:0,class:"text-center q-pa-none"},{default:u(()=>[h("p",Qe,w(e.$t("fetchingData")),1),n(xe,{size:"50px",value:d.progress,color:"accent",class:"q-mt-sm"},{default:u(()=>[h("div",Pe,[n(Se,{color:"white","text-color":"accent",label:d.progressLabel},null,8,["label"])])]),_:1},8,["value"])]),_:1})):ge("",!0)]),_:1})])])]),_:1})]),_:1})]),_:1})}var Ae=se(qe,[["render",Fe]]);export{Ae as default};
