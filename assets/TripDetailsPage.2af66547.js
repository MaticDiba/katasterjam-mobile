import{Q as g,a as u}from"./QFab.77ba2c38.js";import{_ as v,r as w,bs as y,bt as d,am as k,j as n,C as h,D as a,Q as C,d as i,G as t,H as o,m as _,I as l,K as Q,an as D,bq as m,k as f,b3 as E,F,E as O}from"./index.833812ab.js";import{Q as z}from"./QMarkupTable.89c724ae.js";import{u as $}from"./use-quasar.aa50d335.js";import{O as j}from"./OrganizationsList.60143ddf.js";const I={name:"ExcursionDetailsPage",components:{OrganizationsList:j},setup(){const{dialog:e}=$(),x=w(null);return{confirmDialog:e,formatDate:y,excursion:x}},computed:{favouriteIcon(){return this.excursion.isFavourite?"favorite":"favorite_border"},canJoinExcursion(){return!this.excursion.meParticipant&&!this.excursion.requestedJoin}},methods:{showOnMap(){console.log("todo")},async toggleFavourite(){if(this.excursion.isFavourite)try{await d.delete("/api/favorites/",{data:{excursionId:this.excursion.id}}),this.excursion.isFavourite=!1}catch(e){console.error(e)}else try{await d.post("/api/favorites",{excursionId:this.excursion.id}),this.excursion.isFavourite=!0}catch(e){console.error(e)}},async joinExcursion(){this.confirmDialog({title:`${this.$t("confirm")}`,message:`${this.$t("joinExcursionText")}${this.excursion.name}`,cancel:!0,persistent:!0}).onOk(async()=>{try{await d.post(`/api/excursions/${this.excursion.id}/join`),this.excursion.requestedJoin=!0}catch(e){console.error(e)}})}},created(){this.excursion=this.$route.meta.excursion}},L={class:"text-overline text-orange-9"},M={class:"row no-wrap items-center"},N={class:"col text-h6 ellipsis"},P={class:"text-grey text-caption q-pt-md items-center"},T={class:"text-left table-row-fit"},q={class:"text-left table-row-fit"},S={key:0},B={class:"text-left table-row-fit"},J={class:"text-left table-row-fit"},V={class:"text-left table-row-fit"},H={class:"text-left table-row-fit"},A={class:"text-left table-row-fit"},G={class:"text-left table-row-fit"},K={class:"text-left table-row-fit"},R={class:"text-left table-row-fit"},U={class:"text-left table-row-fit"},W={class:"text-left table-row-fit"},X={class:"text-left table-row-fit"},Y={class:"text-left table-row-fit"},Z=["innerHTML"];function tt(e,x,et,s,ot,r){const b=k("OrganizationsList");return n(),h(C,{class:"cave-top"},{default:a(()=>[i(l,null,{default:a(()=>[t("div",L,o(e.$t("excursionDetails")),1),t("div",M,[t("div",N,o(s.excursion.name),1)]),i(g,{class:"absolute",style:{top:"10px",right:"12px"},"vertical-actions-align":"right",color:"primary",glossy:"",icon:"keyboard_arrow_down",direction:"down"},{default:a(()=>[i(u,{"label-position":"left",color:"green",icon:"map",label:e.$t("showDataOnMap"),onClick:r.showOnMap},null,8,["label","onClick"]),i(u,{"label-position":"left",color:"red",icon:r.favouriteIcon,label:e.$t("favourite"),onClick:r.toggleFavourite},null,8,["icon","label","onClick"]),r.canJoinExcursion?(n(),h(u,{key:0,"label-position":"left",color:"orange",icon:"check",label:e.$t("joinExcursion"),onClick:r.joinExcursion},null,8,["label","onClick"])):_("",!0)]),_:1})]),_:1}),i(l,{horizontal:""},{default:a(()=>[i(l,null,{default:a(()=>[t("div",P,o(e.$t("excursionParticipants"))+": "+o(s.excursion.participants),1)]),_:1}),i(Q,{vertical:"",class:"justify-around"},{default:a(()=>[i(D,{name:r.favouriteIcon,color:s.excursion.isFavourite?"red":"default",size:"sm"},null,8,["name","color"])]),_:1})]),_:1}),i(m),i(z,null,{default:a(()=>[t("tbody",null,[t("tr",null,[t("td",T,o(e.$t("caves")),1),t("td",q,[(n(!0),f(F,null,E(s.excursion.caves,(c,p)=>(n(),f("span",{key:c.caveNumber},[O(o(c.caveNumber)+" - "+o(c.name),1),p+1<s.excursion.caves.length?(n(),f("span",S,", ")):_("",!0)]))),128))])]),t("tr",null,[t("td",B,o(e.$t("organizations")),1),t("td",J,[i(b,{organizations:s.excursion.organizations},null,8,["organizations"])])]),t("tr",null,[t("td",V,o(e.$t("dateOfExcursion")),1),t("td",H,o(s.formatDate(s.excursion.dateOfExcursion)),1)]),t("tr",null,[t("td",A,o(e.$t("excursionDuration")),1),t("td",G,o(s.excursion.duration)+"h",1)]),t("tr",null,[t("td",K,o(e.$t("excursionPurpose")),1),t("td",R,o(e.$t(`excursionPurposes.${s.excursion.type}`)),1)]),t("tr",null,[t("td",U,o(e.$t("excursionStatus")),1),t("td",W,o(e.$t(`excursionStatuses.${s.excursion.status}`)),1)]),t("tr",null,[t("td",X,o(e.$t("author")),1),t("td",Y,o(s.excursion.author),1)])])]),_:1}),i(m),i(l,null,{default:a(()=>[t("div",{class:"q-ml-sm",innerHTML:s.excursion.description},null,8,Z)]),_:1})]),_:1})}var lt=v(I,[["render",tt]]);export{lt as default};
