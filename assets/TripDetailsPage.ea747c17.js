import{Q as g,a as f}from"./QFab.e8e44424.js";import{_ as y,r as k,bt as x,j as i,H as m,I as a,Q,d as r,K as t,L as o,m as h,M as u,O as C,ah as F,bw as b,k as c,aQ as p,F as v,J as w}from"./index.3dea3be2.js";import{Q as D}from"./QMarkupTable.192d27aa.js";import{u as E}from"./use-quasar.d0258908.js";import{f as j}from"./date.3d23ecb2.js";const I={name:"ExcursionDetailsPage",setup(){const{dialog:e}=E(),_=k(null);return{confirmDialog:e,formatDate:j,excursion:_}},computed:{favouriteIcon(){return this.excursion.isFavourite?"favorite":"favorite_border"},canJoinExcursion(){return!this.excursion.meParticipant&&!this.excursion.requestedJoin}},methods:{showOnMap(){console.log("todo")},async toggleFavourite(){if(this.excursion.isFavourite)try{await x.delete("/api/favorites/",{data:{excursionId:this.excursion.id}}),this.excursion.isFavourite=!1}catch(e){console.error(e)}else try{await x.post("/api/favorites",{excursionId:this.excursion.id}),this.excursion.isFavourite=!0}catch(e){console.error(e)}},async joinExcursion(){this.confirmDialog({title:`${this.$t("confirm")}`,message:`${this.$t("joinExcursionText")}${this.excursion.name}`,cancel:!0,persistent:!0}).onOk(async()=>{try{await x.post(`/api/excursions/${this.excursion.id}/join`),this.excursion.requestedJoin=!0}catch(e){console.error(e)}})}},created(){this.excursion=this.$route.meta.excursion}},M={class:"text-overline text-orange-9"},O={class:"row no-wrap items-center"},$={class:"col text-h6 ellipsis"},N={class:"text-grey text-caption q-pt-md items-center"},P={class:"text-left table-row-fit"},T={class:"text-left table-row-fit"},J={key:0},S={class:"text-left table-row-fit"},q={class:"text-left table-row-fit"},z={key:0},B={class:"text-left table-row-fit"},L={class:"text-left table-row-fit"},V={class:"text-left table-row-fit"},H={class:"text-left table-row-fit"},A={class:"text-left table-row-fit"},K={class:"text-left table-row-fit"},G={class:"text-left table-row-fit"},R={class:"text-left table-row-fit"},U={class:"text-left table-row-fit"},W={class:"text-left table-row-fit"},X=["innerHTML"];function Y(e,_,Z,s,tt,n){return i(),m(Q,{class:"cave-top"},{default:a(()=>[r(u,null,{default:a(()=>[t("div",M,o(e.$t("excursionDetails")),1),t("div",O,[t("div",$,o(s.excursion.name),1)]),r(g,{class:"absolute",style:{top:"10px",right:"12px"},"vertical-actions-align":"right",color:"primary",glossy:"",icon:"keyboard_arrow_down",direction:"down"},{default:a(()=>[r(f,{"label-position":"left",color:"green",icon:"map",label:e.$t("showDataOnMap"),onClick:n.showOnMap},null,8,["label","onClick"]),r(f,{"label-position":"left",color:"red",icon:n.favouriteIcon,label:e.$t("favourite"),onClick:n.toggleFavourite},null,8,["icon","label","onClick"]),n.canJoinExcursion?(i(),m(f,{key:0,"label-position":"left",color:"orange",icon:"check",label:e.$t("joinExcursion"),onClick:n.joinExcursion},null,8,["label","onClick"])):h("",!0)]),_:1})]),_:1}),r(u,{horizontal:""},{default:a(()=>[r(u,null,{default:a(()=>[t("div",N,o(e.$t("excursionParticipants"))+": "+o(s.excursion.participants),1)]),_:1}),r(C,{vertical:"",class:"justify-around"},{default:a(()=>[r(F,{name:n.favouriteIcon,color:s.excursion.isFavourite?"red":"default",size:"sm"},null,8,["name","color"])]),_:1})]),_:1}),r(b),r(D,null,{default:a(()=>[t("tbody",null,[t("tr",null,[t("td",P,o(e.$t("caves")),1),t("td",T,[(i(!0),c(v,null,p(s.excursion.caves,(l,d)=>(i(),c("span",{key:l.caveNumber},[w(o(l.caveNumber)+" - "+o(l.name),1),d+1<s.excursion.caves.length?(i(),c("span",J,", ")):h("",!0)]))),128))])]),t("tr",null,[t("td",S,o(e.$t("organizations")),1),t("td",q,[(i(!0),c(v,null,p(s.excursion.organizations,(l,d)=>(i(),c("span",{key:l.id},[w(o(l.name),1),d+1<s.excursion.organizations.length?(i(),c("span",z,", ")):h("",!0)]))),128))])]),t("tr",null,[t("td",B,o(e.$t("dateOfExcursion")),1),t("td",L,o(s.formatDate(s.excursion.dateOfExcursion)),1)]),t("tr",null,[t("td",V,o(e.$t("excursionDuration")),1),t("td",H,o(s.excursion.duration)+"h",1)]),t("tr",null,[t("td",A,o(e.$t("excursionPurpose")),1),t("td",K,o(e.$t(`excursionPurposes.${s.excursion.type}`)),1)]),t("tr",null,[t("td",G,o(e.$t("excursionStatus")),1),t("td",R,o(e.$t(`excursionStatuses.${s.excursion.status}`)),1)]),t("tr",null,[t("td",U,o(e.$t("author")),1),t("td",W,o(s.excursion.author),1)])])]),_:1}),r(b),r(u,null,{default:a(()=>[t("div",{class:"q-ml-sm",innerHTML:s.excursion.description},null,8,X)]),_:1})]),_:1})}var at=y(I,[["render",Y]]);export{at as default};
