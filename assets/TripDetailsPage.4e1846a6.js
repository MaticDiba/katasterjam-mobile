import{Q as g,a as u}from"./QFab.799a9197.js";import{_ as v,r as w,bx as d,ag as y,j as n,H as h,I as a,Q as k,d as i,K as t,L as o,m as _,M as l,O as C,ah as Q,bA as m,k as f,aK as F,F as O,J as D}from"./index.315eb3dd.js";import{Q as E}from"./QMarkupTable.1cd5f2fb.js";import{u as z}from"./use-quasar.f252f1be.js";import{f as $}from"./date.3d23ecb2.js";import{O as j}from"./OrganizationsList.9df873da.js";const I={name:"ExcursionDetailsPage",components:{OrganizationsList:j},setup(){const{dialog:e}=z(),x=w(null);return{confirmDialog:e,formatDate:$,excursion:x}},computed:{favouriteIcon(){return this.excursion.isFavourite?"favorite":"favorite_border"},canJoinExcursion(){return!this.excursion.meParticipant&&!this.excursion.requestedJoin}},methods:{showOnMap(){console.log("todo")},async toggleFavourite(){if(this.excursion.isFavourite)try{await d.delete("/api/favorites/",{data:{excursionId:this.excursion.id}}),this.excursion.isFavourite=!1}catch(e){console.error(e)}else try{await d.post("/api/favorites",{excursionId:this.excursion.id}),this.excursion.isFavourite=!0}catch(e){console.error(e)}},async joinExcursion(){this.confirmDialog({title:`${this.$t("confirm")}`,message:`${this.$t("joinExcursionText")}${this.excursion.name}`,cancel:!0,persistent:!0}).onOk(async()=>{try{await d.post(`/api/excursions/${this.excursion.id}/join`),this.excursion.requestedJoin=!0}catch(e){console.error(e)}})}},created(){this.excursion=this.$route.meta.excursion}},L={class:"text-overline text-orange-9"},M={class:"row no-wrap items-center"},N={class:"col text-h6 ellipsis"},P={class:"text-grey text-caption q-pt-md items-center"},T={class:"text-left table-row-fit"},J={class:"text-left table-row-fit"},S={key:0},q={class:"text-left table-row-fit"},B={class:"text-left table-row-fit"},V={class:"text-left table-row-fit"},A={class:"text-left table-row-fit"},H={class:"text-left table-row-fit"},K={class:"text-left table-row-fit"},G={class:"text-left table-row-fit"},R={class:"text-left table-row-fit"},U={class:"text-left table-row-fit"},W={class:"text-left table-row-fit"},X={class:"text-left table-row-fit"},Y={class:"text-left table-row-fit"},Z=["innerHTML"];function tt(e,x,et,s,ot,r){const p=y("OrganizationsList");return n(),h(k,{class:"cave-top"},{default:a(()=>[i(l,null,{default:a(()=>[t("div",L,o(e.$t("excursionDetails")),1),t("div",M,[t("div",N,o(s.excursion.name),1)]),i(g,{class:"absolute",style:{top:"10px",right:"12px"},"vertical-actions-align":"right",color:"primary",glossy:"",icon:"keyboard_arrow_down",direction:"down"},{default:a(()=>[i(u,{"label-position":"left",color:"green",icon:"map",label:e.$t("showDataOnMap"),onClick:r.showOnMap},null,8,["label","onClick"]),i(u,{"label-position":"left",color:"red",icon:r.favouriteIcon,label:e.$t("favourite"),onClick:r.toggleFavourite},null,8,["icon","label","onClick"]),r.canJoinExcursion?(n(),h(u,{key:0,"label-position":"left",color:"orange",icon:"check",label:e.$t("joinExcursion"),onClick:r.joinExcursion},null,8,["label","onClick"])):_("",!0)]),_:1})]),_:1}),i(l,{horizontal:""},{default:a(()=>[i(l,null,{default:a(()=>[t("div",P,o(e.$t("excursionParticipants"))+": "+o(s.excursion.participants),1)]),_:1}),i(C,{vertical:"",class:"justify-around"},{default:a(()=>[i(Q,{name:r.favouriteIcon,color:s.excursion.isFavourite?"red":"default",size:"sm"},null,8,["name","color"])]),_:1})]),_:1}),i(m),i(E,null,{default:a(()=>[t("tbody",null,[t("tr",null,[t("td",T,o(e.$t("caves")),1),t("td",J,[(n(!0),f(O,null,F(s.excursion.caves,(c,b)=>(n(),f("span",{key:c.caveNumber},[D(o(c.caveNumber)+" - "+o(c.name),1),b+1<s.excursion.caves.length?(n(),f("span",S,", ")):_("",!0)]))),128))])]),t("tr",null,[t("td",q,o(e.$t("organizations")),1),t("td",B,[i(p,{organizations:s.excursion.organizations},null,8,["organizations"])])]),t("tr",null,[t("td",V,o(e.$t("dateOfExcursion")),1),t("td",A,o(s.formatDate(s.excursion.dateOfExcursion)),1)]),t("tr",null,[t("td",H,o(e.$t("excursionDuration")),1),t("td",K,o(s.excursion.duration)+"h",1)]),t("tr",null,[t("td",G,o(e.$t("excursionPurpose")),1),t("td",R,o(e.$t(`excursionPurposes.${s.excursion.type}`)),1)]),t("tr",null,[t("td",U,o(e.$t("excursionStatus")),1),t("td",W,o(e.$t(`excursionStatuses.${s.excursion.status}`)),1)]),t("tr",null,[t("td",X,o(e.$t("author")),1),t("td",Y,o(s.excursion.author),1)])])]),_:1}),i(m),i(l,null,{default:a(()=>[t("div",{class:"q-ml-sm",innerHTML:s.excursion.description},null,8,Z)]),_:1})]),_:1})}var ct=v(I,[["render",tt]]);export{ct as default};
