import{Q as g,a as u}from"./QFab.5d2ab552.js";import{d2 as v,r as w,eo as y,ej as d,dQ as k,cM as n,d8 as h,d9 as a,dd as C,d as i,db as t,dc as o,cV as _,de as l,dg as Q,dR as F,em as m,cN as f,e9 as D,F as E,da as O}from"./index.513fe5bd.js";import{Q as z}from"./QMarkupTable.6ce5d9d6.js";import{u as $}from"./use-quasar.47a30d61.js";import{O as j}from"./OrganizationsList.38601ea8.js";const M={name:"ExcursionDetailsPage",components:{OrganizationsList:j},setup(){const{dialog:e}=$(),x=w(null);return{confirmDialog:e,formatDate:y,excursion:x}},computed:{favouriteIcon(){return this.excursion.isFavourite?"favorite":"favorite_border"},canJoinExcursion(){return!this.excursion.meParticipant&&!this.excursion.requestedJoin}},methods:{showOnMap(){console.log("todo")},async toggleFavourite(){if(this.excursion.isFavourite)try{await d.delete("/api/favorites/",{data:{excursionId:this.excursion.id}}),this.excursion.isFavourite=!1}catch(e){console.error(e)}else try{await d.post("/api/favorites",{excursionId:this.excursion.id}),this.excursion.isFavourite=!0}catch(e){console.error(e)}},async joinExcursion(){this.confirmDialog({title:`${this.$t("confirm")}`,message:`${this.$t("joinExcursionText")}${this.excursion.name}`,cancel:!0,persistent:!0}).onOk(async()=>{try{await d.post(`/api/excursions/${this.excursion.id}/join`),this.excursion.requestedJoin=!0}catch(e){console.error(e)}})}},created(){this.excursion=this.$route.meta.excursion}},N={class:"text-overline text-orange-9"},I={class:"row no-wrap items-center"},L={class:"col text-h6 ellipsis"},P={class:"text-grey text-caption q-pt-md items-center"},T={class:"text-left table-row-fit"},S={class:"text-left table-row-fit"},V={key:0},q={class:"text-left table-row-fit"},B={class:"text-left table-row-fit"},J={class:"text-left table-row-fit"},A={class:"text-left table-row-fit"},H={class:"text-left table-row-fit"},R={class:"text-left table-row-fit"},G={class:"text-left table-row-fit"},K={class:"text-left table-row-fit"},U={class:"text-left table-row-fit"},W={class:"text-left table-row-fit"},X={class:"text-left table-row-fit"},Y={class:"text-left table-row-fit"},Z=["innerHTML"];function tt(e,x,et,s,ot,r){const p=k("OrganizationsList");return n(),h(C,{class:"cave-top"},{default:a(()=>[i(l,null,{default:a(()=>[t("div",N,o(e.$t("excursionDetails")),1),t("div",I,[t("div",L,o(s.excursion.name),1)]),i(g,{class:"absolute",style:{top:"10px",right:"12px"},"vertical-actions-align":"right",color:"primary",glossy:"",icon:"keyboard_arrow_down",direction:"down"},{default:a(()=>[i(u,{"label-position":"left",color:"green",icon:"map",label:e.$t("showDataOnMap"),onClick:r.showOnMap},null,8,["label","onClick"]),i(u,{"label-position":"left",color:"red",icon:r.favouriteIcon,label:e.$t("favourite"),onClick:r.toggleFavourite},null,8,["icon","label","onClick"]),r.canJoinExcursion?(n(),h(u,{key:0,"label-position":"left",color:"orange",icon:"check",label:e.$t("joinExcursion"),onClick:r.joinExcursion},null,8,["label","onClick"])):_("",!0)]),_:1})]),_:1}),i(l,{horizontal:""},{default:a(()=>[i(l,null,{default:a(()=>[t("div",P,o(e.$t("excursionParticipants"))+": "+o(s.excursion.participants),1)]),_:1}),i(Q,{vertical:"",class:"justify-around"},{default:a(()=>[i(F,{name:r.favouriteIcon,color:s.excursion.isFavourite?"red":"default",size:"sm"},null,8,["name","color"])]),_:1})]),_:1}),i(m),i(z,null,{default:a(()=>[t("tbody",null,[t("tr",null,[t("td",T,o(e.$t("caves")),1),t("td",S,[(n(!0),f(E,null,D(s.excursion.caves,(c,b)=>(n(),f("span",{key:c.caveNumber},[O(o(c.caveNumber)+" - "+o(c.name),1),b+1<s.excursion.caves.length?(n(),f("span",V,", ")):_("",!0)]))),128))])]),t("tr",null,[t("td",q,o(e.$t("organizations")),1),t("td",B,[i(p,{organizations:s.excursion.organizations},null,8,["organizations"])])]),t("tr",null,[t("td",J,o(e.$t("dateOfExcursion")),1),t("td",A,o(s.formatDate(s.excursion.dateOfExcursion)),1)]),t("tr",null,[t("td",H,o(e.$t("excursionDuration")),1),t("td",R,o(s.excursion.duration)+"h",1)]),t("tr",null,[t("td",G,o(e.$t("excursionPurpose")),1),t("td",K,o(e.$t(`excursionPurposes.${s.excursion.type}`)),1)]),t("tr",null,[t("td",U,o(e.$t("excursionStatus")),1),t("td",W,o(e.$t(`excursionStatuses.${s.excursion.status}`)),1)]),t("tr",null,[t("td",X,o(e.$t("author")),1),t("td",Y,o(s.excursion.author),1)])])]),_:1}),i(m),i(l,null,{default:a(()=>[t("div",{class:"q-ml-sm",innerHTML:s.excursion.description},null,8,Z)]),_:1})]),_:1})}var lt=v(M,[["render",tt]]);export{lt as default};
