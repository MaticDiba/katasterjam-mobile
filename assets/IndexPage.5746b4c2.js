import{i as yt,W as b,X as mt,c as T,g as Ct,x as wt,h as B,s as at,_ as S,j as N,H as E,I as m,l as kt,aw as Lt,am as Tt,r as w,ag as _,d as f,k as st,Q as Mt,M as Rt,K as z,L as $,ah as ct,ax as lt,P as X,ay as Pt,F as ut,az as At,aA as Nt,m as It,af as $t}from"./index.c223e8cd.js";import{t as F,a as tt,s as x,l as q,b as Ft,c as D,G as R,d as ht,S as U,f as St,n as xt,e as Et,g as Gt,i as bt,h as zt,j as jt,k as O,m as Bt,P as H,o as Xt,p as Yt,q as gt,F as Y,C as Qt}from"./CartoLayers.828db69b.js";import{Q as qt}from"./QPage.f1df16a4.js";const Dt={position:{type:String,default:"bottom-right",validator:t=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(t)},offset:{type:Array,validator:t=>t.length===2},expand:Boolean};function Ut(){const{props:t,proxy:{$q:n}}=Ct(),e=yt(mt,b);if(e===b)return console.error("QPageSticky needs to be child of QLayout"),b;const o=T(()=>{const h=t.position;return{top:h.indexOf("top")>-1,right:h.indexOf("right")>-1,bottom:h.indexOf("bottom")>-1,left:h.indexOf("left")>-1,vertical:h==="top"||h==="bottom",horizontal:h==="left"||h==="right"}}),r=T(()=>e.header.offset),i=T(()=>e.right.offset),a=T(()=>e.footer.offset),s=T(()=>e.left.offset),l=T(()=>{let h=0,v=0;const g=o.value,p=n.lang.rtl===!0?-1:1;g.top===!0&&r.value!==0?v=`${r.value}px`:g.bottom===!0&&a.value!==0&&(v=`${-a.value}px`),g.left===!0&&s.value!==0?h=`${p*s.value}px`:g.right===!0&&i.value!==0&&(h=`${-p*i.value}px`);const d={transform:`translate(${h}, ${v})`};return t.offset&&(d.margin=`${t.offset[1]}px ${t.offset[0]}px`),g.vertical===!0?(s.value!==0&&(d[n.lang.rtl===!0?"right":"left"]=`${s.value}px`),i.value!==0&&(d[n.lang.rtl===!0?"left":"right"]=`${i.value}px`)):g.horizontal===!0&&(r.value!==0&&(d.top=`${r.value}px`),a.value!==0&&(d.bottom=`${a.value}px`)),d}),c=T(()=>`q-page-sticky row flex-center fixed-${t.position} q-page-sticky--${t.expand===!0?"expand":"shrink"}`);function u(h){const v=wt(h.default);return B("div",{class:c.value,style:l.value},t.expand===!0?v:[B("div",v)])}return{$layout:e,getStickyContent:u}}var nt=at({name:"QPageSticky",props:Dt,setup(t,{slots:n}){const{getStickyContent:e}=Ut();return()=>e(n)}}),W=63710088e-1;function Ot(t,n,e){var o=e||W,r=F(t[1]),i=F(n[1]),a=(i-r)/2,s=F(n[0]-t[0])/2,l=Math.sin(a)*Math.sin(a)+Math.sin(s)*Math.sin(s)*Math.cos(r)*Math.cos(i);return 2*o*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}function j(t,n){for(var e=0,o=0,r=t.length;o<r-1;++o)e+=Ot(t[o],t[o+1],n);return e}function Q(t,n){var e=n||{},o=e.radius||W,r=e.projection||"EPSG:3857",i=t.getType();i!=="GeometryCollection"&&(t=t.clone().transform(r,"EPSG:4326"));var a=0,s,l,c,u,h,v;switch(i){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":{s=t.getCoordinates(),a=j(s,o);break}case"MultiLineString":case"Polygon":{for(s=t.getCoordinates(),c=0,u=s.length;c<u;++c)a+=j(s[c],o);break}case"MultiPolygon":{for(s=t.getCoordinates(),c=0,u=s.length;c<u;++c)for(l=s[c],h=0,v=l.length;h<v;++h)a+=j(l[h],o);break}case"GeometryCollection":{var g=t.getGeometries();for(c=0,u=g.length;c<u;++c)a+=Q(g[c],n);break}default:throw new Error("Unsupported geometry type: "+i)}return a}function Ht(t,n,e,o){var r=o||W,i=F(t[1]),a=F(t[0]),s=n/r,l=Math.asin(Math.sin(i)*Math.cos(s)+Math.cos(i)*Math.sin(s)*Math.cos(e)),c=a+Math.atan2(Math.sin(e)*Math.sin(s)*Math.cos(i),Math.cos(s)-Math.sin(i)*Math.sin(l));return[tt(c),tt(l)]}function et(t,n,e,o,r,i,a){var s=t[n],l=t[n+1],c=t[e]-s,u=t[e+1]-l,h;if(c===0&&u===0)h=n;else{var v=((r-s)*c+(i-l)*u)/(c*c+u*u);if(v>1)h=e;else if(v>0){for(var g=0;g<o;++g)a[g]=q(t[n+g],t[e+g],v);a.length=o;return}else h=n}for(var g=0;g<o;++g)a[g]=t[h+g];a.length=o}function Z(t,n,e,o,r){var i=t[n],a=t[n+1];for(n+=o;n<e;n+=o){var s=t[n],l=t[n+1],c=x(i,a,s,l);c>r&&(r=c),i=s,a=l}return r}function Wt(t,n,e,o,r){for(var i=0,a=e.length;i<a;++i){var s=e[i];r=Z(t,n,s,o,r),n=s}return r}function V(t,n,e,o,r,i,a,s,l,c,u){if(n==e)return c;var h,v;if(r===0)if(v=x(a,s,t[n],t[n+1]),v<c){for(h=0;h<o;++h)l[h]=t[n+h];return l.length=o,v}else return c;for(var g=u||[NaN,NaN],p=n+o;p<e;)if(et(t,p-o,p,o,a,s,g),v=x(a,s,g[0],g[1]),v<c){for(c=v,h=0;h<o;++h)l[h]=g[h];l.length=o,p+=o}else p+=o*Math.max((Math.sqrt(v)-Math.sqrt(c))/r|0,1);if(i&&(et(t,e-o,n,o,a,s,g),v=x(a,s,g[0],g[1]),v<c)){for(c=v,h=0;h<o;++h)l[h]=g[h];l.length=o}return c}function Zt(t,n,e,o,r,i,a,s,l,c,u){for(var h=u||[NaN,NaN],v=0,g=e.length;v<g;++v){var p=e[v];c=V(t,n,p,o,r,i,a,s,l,c,h),n=p}return c}function vt(t,n,e,o,r,i,a){var s=(e-n)/o;if(s<3){for(;n<e;n+=o)i[a++]=t[n],i[a++]=t[n+1];return a}var l=new Array(s);l[0]=1,l[s-1]=1;for(var c=[n,e-o],u=0;c.length>0;){for(var h=c.pop(),v=c.pop(),g=0,p=t[v],d=t[v+1],C=t[h],P=t[h+1],y=v+o;y<h;y+=o){var k=t[y],L=t[y+1],I=Ft(k,L,p,d,C,P);I>g&&(u=y,g=I)}g>r&&(l[(u-n)/o]=1,v+o<u&&c.push(v,u),u+o<h&&c.push(u,h))}for(var y=0;y<s;++y)l[y]&&(i[a++]=t[n+y*o],i[a++]=t[n+y*o+1]);return a}function A(t,n){return n*Math.round(t/n)}function Vt(t,n,e,o,r,i,a){if(n==e)return a;var s=A(t[n],r),l=A(t[n+1],r);n+=o,i[a++]=s,i[a++]=l;var c,u;do if(c=A(t[n],r),u=A(t[n+1],r),n+=o,n==e)return i[a++]=c,i[a++]=u,a;while(c==s&&u==l);for(;n<e;){var h=A(t[n],r),v=A(t[n+1],r);if(n+=o,!(h==c&&v==u)){var g=c-s,p=u-l,d=h-s,C=v-l;if(g*C==p*d&&(g<0&&d<g||g==d||g>0&&d>g)&&(p<0&&C<p||p==C||p>0&&C>p)){c=h,u=v;continue}i[a++]=c,i[a++]=u,s=c,l=u,c=h,u=v}}return i[a++]=c,i[a++]=u,a}function Kt(t,n,e,o,r,i,a,s){for(var l=0,c=e.length;l<c;++l){var u=e[l];a=Vt(t,n,u,o,r,i,a),s.push(a),n=u}return a}function K(t,n,e,o,r){for(var i=r!==void 0?r:[],a=0,s=n;s<e;s+=o)i[a++]=t.slice(s,s+o);return i.length=a,i}function Jt(t,n,e,o,r){for(var i=r!==void 0?r:[],a=0,s=0,l=e.length;s<l;++s){var c=e[s];i[a++]=K(t,n,c,o,i[a]),n=c}return i.length=a,i}function pt(t,n,e,o){for(var r=0,i=t[e-o],a=t[e-o+1];n<e;n+=o){var s=t[n],l=t[n+1];r+=a*s-i*l,i=s,a=l}return r/2}function tn(t,n,e,o){for(var r=0,i=0,a=e.length;i<a;++i){var s=e[i];r+=pt(t,n,s,o),n=s}return r}var nn=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(o[i]=r[i])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function o(){this.constructor=n}n.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}}(),en=function(t){nn(n,t);function n(e,o){var r=t.call(this)||this;return r.maxDelta_=-1,r.maxDeltaRevision_=-1,o!==void 0&&!Array.isArray(e[0])?r.setFlatCoordinates(o,e):r.setCoordinates(e,o),r}return n.prototype.clone=function(){return new n(this.flatCoordinates.slice(),this.layout)},n.prototype.closestPointXY=function(e,o,r,i){return i<D(this.getExtent(),e,o)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Z(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),V(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,o,r,i))},n.prototype.getArea=function(){return pt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getCoordinates=function(){return K(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getSimplifiedGeometryInternal=function(e){var o=[];return o.length=vt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,o,0),new n(o,R.XY)},n.prototype.getType=function(){return"LinearRing"},n.prototype.intersectsExtent=function(e){return!1},n.prototype.setCoordinates=function(e,o){this.setLayout(o,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ht(this.flatCoordinates,0,e,this.stride),this.changed()},n}(U),ot=en;function on(t,n,e,o,r){var i=St(r,function(a){return!M(t,n,e,o,a[0],a[1])});return!i}function M(t,n,e,o,r,i){for(var a=0,s=t[e-o],l=t[e-o+1];n<e;n+=o){var c=t[n],u=t[n+1];l<=i?u>i&&(c-s)*(i-l)-(r-s)*(u-l)>0&&a++:u<=i&&(c-s)*(i-l)-(r-s)*(u-l)<0&&a--,s=c,l=u}return a!==0}function ft(t,n,e,o,r,i){if(e.length===0||!M(t,n,e[0],o,r,i))return!1;for(var a=1,s=e.length;a<s;++a)if(M(t,e[a-1],e[a],o,r,i))return!1;return!0}function rn(t,n,e,o,r,i,a){for(var s,l,c,u,h,v,g,p=r[i+1],d=[],C=0,P=e.length;C<P;++C){var y=e[C];for(u=t[y-o],v=t[y-o+1],s=n;s<y;s+=o)h=t[s],g=t[s+1],(p<=v&&g<=p||v<=p&&p<=g)&&(c=(p-v)/(g-v)*(h-u)+u,d.push(c)),u=h,v=g}var k=NaN,L=-1/0;for(d.sort(xt),u=d[0],s=1,l=d.length;s<l;++s){h=d[s];var I=Math.abs(h-u);I>L&&(c=(u+h)/2,ft(t,n,e,o,c,p)&&(k=c,L=I)),u=h}return isNaN(k)&&(k=r[i]),a?(a.push(k,p,L),a):[k,p,L]}function _t(t,n,e,o,r){var i;for(n+=o;n<e;n+=o)if(i=r(t.slice(n-o,n),t.slice(n,n+o)),i)return i;return!1}function J(t,n,e,o,r){var i=Et(Gt(),t,n,e,o);return bt(r,i)?zt(r,i)||i[0]>=r[0]&&i[2]<=r[2]||i[1]>=r[1]&&i[3]<=r[3]?!0:_t(t,n,e,o,function(a,s){return jt(r,a,s)}):!1}function an(t,n,e,o,r){return!!(J(t,n,e,o,r)||M(t,n,e,o,r[0],r[1])||M(t,n,e,o,r[0],r[3])||M(t,n,e,o,r[2],r[1])||M(t,n,e,o,r[2],r[3]))}function sn(t,n,e,o,r){if(!an(t,n,e[0],o,r))return!1;if(e.length===1)return!0;for(var i=1,a=e.length;i<a;++i)if(on(t,e[i-1],e[i],o,r)&&!J(t,e[i-1],e[i],o,r))return!1;return!0}function cn(t,n,e,o){for(;n<e-o;){for(var r=0;r<o;++r){var i=t[n+r];t[n+r]=t[e-o+r],t[e-o+r]=i}n+=o,e-=o}}function dt(t,n,e,o){for(var r=0,i=t[e-o],a=t[e-o+1];n<e;n+=o){var s=t[n],l=t[n+1];r+=(s-i)*(l+a),i=s,a=l}return r===0?void 0:r>0}function ln(t,n,e,o,r){for(var i=r!==void 0?r:!1,a=0,s=e.length;a<s;++a){var l=e[a],c=dt(t,n,l,o);if(a===0){if(i&&c||!i&&!c)return!1}else if(i&&!c||!i&&c)return!1;n=l}return!0}function rt(t,n,e,o,r){for(var i=r!==void 0?r:!1,a=0,s=e.length;a<s;++a){var l=e[a],c=dt(t,n,l,o),u=a===0?i&&c||!i&&!c:i&&!c||!i&&c;u&&cn(t,n,l,o),n=l}return n}var un=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(o[i]=r[i])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function o(){this.constructor=n}n.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}}(),hn=function(t){un(n,t);function n(e,o,r){var i=t.call(this)||this;return i.ends_=[],i.flatInteriorPointRevision_=-1,i.flatInteriorPoint_=null,i.maxDelta_=-1,i.maxDeltaRevision_=-1,i.orientedRevision_=-1,i.orientedFlatCoordinates_=null,o!==void 0&&r?(i.setFlatCoordinates(o,e),i.ends_=r):i.setCoordinates(e,o),i}return n.prototype.appendLinearRing=function(e){this.flatCoordinates?O(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},n.prototype.clone=function(){var e=new n(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e},n.prototype.closestPointXY=function(e,o,r,i){return i<D(this.getExtent(),e,o)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wt(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Zt(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,o,r,i))},n.prototype.containsXY=function(e,o){return ft(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,o)},n.prototype.getArea=function(){return tn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},n.prototype.getCoordinates=function(e){var o;return e!==void 0?(o=this.getOrientedFlatCoordinates().slice(),rt(o,0,this.ends_,this.stride,e)):o=this.flatCoordinates,Jt(o,0,this.ends_,this.stride)},n.prototype.getEnds=function(){return this.ends_},n.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var e=Bt(this.getExtent());this.flatInteriorPoint_=rn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},n.prototype.getInteriorPoint=function(){return new H(this.getFlatInteriorPoint(),R.XYM)},n.prototype.getLinearRingCount=function(){return this.ends_.length},n.prototype.getLinearRing=function(e){return e<0||this.ends_.length<=e?null:new ot(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)},n.prototype.getLinearRings=function(){for(var e=this.layout,o=this.flatCoordinates,r=this.ends_,i=[],a=0,s=0,l=r.length;s<l;++s){var c=r[s],u=new ot(o.slice(a,c),e);i.push(u),a=c}return i},n.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var e=this.flatCoordinates;ln(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=rt(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},n.prototype.getSimplifiedGeometryInternal=function(e){var o=[],r=[];return o.length=Kt(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),o,0,r),new n(o,R.XY,r)},n.prototype.getType=function(){return"Polygon"},n.prototype.intersectsExtent=function(e){return sn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)},n.prototype.setCoordinates=function(e,o){this.setLayout(o,e,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=Xt(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()},n}(U);function gn(t,n,e,o){for(var r=e||32,i=[],a=0;a<r;++a)O(i,Ht(t,n,2*Math.PI*a/r,o));return i.push(i[0],i[1]),new hn(i,R.XY,[i.length])}function vn(t,n,e,o,r,i,a){var s,l,c=(e-n)/o;if(c===1)s=n;else if(c===2)s=n,l=r;else if(c!==0){for(var u=t[n],h=t[n+1],v=0,g=[0],p=n+o;p<e;p+=o){var d=t[p],C=t[p+1];v+=Math.sqrt((d-u)*(d-u)+(C-h)*(C-h)),g.push(v),u=d,h=C}var P=r*v,y=Yt(g,P);y<0?(l=(P-g[-y-2])/(g[-y-1]-g[-y-2]),s=n+(-y-2)*o):s=n+y*o}for(var k=a>1?a:2,L=i||new Array(k),p=0;p<k;++p)L[p]=s===void 0?NaN:l===void 0?t[s+p]:q(t[s+p],t[s+o+p],l);return L}function pn(t,n,e,o,r,i){if(e==n)return null;var a;if(r<t[n+o-1])return i?(a=t.slice(n,n+o),a[o-1]=r,a):null;if(t[e-1]<r)return i?(a=t.slice(e-o,e),a[o-1]=r,a):null;if(r==t[n+o-1])return t.slice(n,n+o);for(var s=n/o,l=e/o;s<l;){var c=s+l>>1;r<t[(c+1)*o-1]?l=c:s=c+1}var u=t[s*o-1];if(r==u)return t.slice((s-1)*o,(s-1)*o+o);var h=t[(s+1)*o-1],v=(r-u)/(h-u);a=[];for(var g=0;g<o-1;++g)a.push(q(t[(s-1)*o+g],t[s*o+g],v));return a.push(r),a}function fn(t,n,e,o){for(var r=t[n],i=t[n+1],a=0,s=n+o;s<e;s+=o){var l=t[s],c=t[s+1];a+=Math.sqrt((l-r)*(l-r)+(c-i)*(c-i)),r=l,i=c}return a}var _n=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,r){o.__proto__=r}||function(o,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(o[i]=r[i])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function o(){this.constructor=n}n.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}}(),dn=function(t){_n(n,t);function n(e,o){var r=t.call(this)||this;return r.flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,o!==void 0&&!Array.isArray(e[0])?r.setFlatCoordinates(o,e):r.setCoordinates(e,o),r}return n.prototype.appendCoordinate=function(e){this.flatCoordinates?O(this.flatCoordinates,e):this.flatCoordinates=e.slice(),this.changed()},n.prototype.clone=function(){var e=new n(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e},n.prototype.closestPointXY=function(e,o,r,i){return i<D(this.getExtent(),e,o)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Z(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),V(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,o,r,i))},n.prototype.forEachSegment=function(e){return _t(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)},n.prototype.getCoordinateAtM=function(e,o){if(this.layout!=R.XYM&&this.layout!=R.XYZM)return null;var r=o!==void 0?o:!1;return pn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,r)},n.prototype.getCoordinates=function(){return K(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getCoordinateAt=function(e,o){return vn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,o,this.stride)},n.prototype.getLength=function(){return fn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},n.prototype.getSimplifiedGeometryInternal=function(e){var o=[];return o.length=vt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,o,0),new n(o,R.XY)},n.prototype.getType=function(){return"LineString"},n.prototype.intersectsExtent=function(e){return J(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)},n.prototype.setCoordinates=function(e,o){this.setLayout(o,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ht(this.flatCoordinates,0,e,this.stride),this.changed()},n}(U),it=dn;const yn={name:"PageFullScreen",methods:{tweak(){return{height:this.$q.screen.height-50+"px"}},myTweak(t){t||(t=0);const n=this.$q.platform.is.cordova?`calc(100vh - ${t}px)`:window.innerHeight-t+"px";return this.$store.state.windowSize=n,{minHeight:n}}}};function mn(t,n,e,o,r,i){return N(),E(qt,{"style-fn":i.tweak,class:"scroll-y fhpadd"},{default:m(()=>[kt(t.$slots,"default")]),_:3},8,["style-fn"])}var Cn=S(yn,[["render",mn]]);const G=Lt("location",{state:()=>({foregroundLocationActivated:!1,isCordova:Tt.is.cordova,projection:null,rotation:45,watchId:null,locationTracking:!1,navigationActive:!1,myLocation:{},myTrack:[],navigateTo:[]}),getters:{getProjection(t){return t.projection},getRotation(t){return t.rotation},getLocationTracking(t){return t.locationTracking},getNavigationActive(t){return t.navigationActive},getMyLocation(t){return t.myLocation},getMyLocationAccuracy(t){return t.myLocation.accuracy},getMyLocationCoordinates(t){return t.myLocation.coordinates},getMyTrack(t){return t.myTrack},getNavigateTo(t){return t.navigateTo},foregroundNotNeeded(t){return!t.locationTracking&&!t.navigationActive}},actions:{initialize(t){this.projection=t,this.watchId&&navigator.compass.clearWatch(this.watchId),this.isCordova&&(window.BackgroundGeolocation.configure({locationProvider:window.BackgroundGeolocation.DISTANCE_FILTER_PROVIDER,desiredAccuracy:window.BackgroundGeolocation.MEDIUM_ACCURACY,stationaryRadius:10,distanceFilter:10,stopOnTerminate:!1,debug:!0,startForeground:!0,notificationsEnabled:!0,httpHeaders:{"X-Auth":"\u010De ga rabi\u0161"},interval:5e3,fastestInterval:2e3,activitiesInterval:1e3}),window.BackgroundGeolocation.on("authorization",n=>{n!==window.BackgroundGeolocation.AUTHORIZED&&setTimeout(()=>{navigator.notification.confirm("Please enable location access",e=>{e===1&&window.BackgroundGeolocation.showAppSettings()},"Kataster jam")},1e3)}),window.BackgroundGeolocation.on("location",n=>{this.newLocationUpdate(n)}),this.watchId=navigator.compass.watchHeading(n=>{this.rotation=n.magneticHeading},n=>{alert("Compass error: "+n.code)},{frequency:1e3})),navigator.geolocation.watchPosition(n=>{this.foregroundLocationActivated&&n.coords.accuracy>10&&this.isCordova||this.newLocationUpdate(n.coords)},(n,e)=>{console.error("Error when trying to fetch location",n,e)},{enableHighAccuracy:!0})},newLocationUpdate(t){const n=gt([t.longitude,t.latitude]);this.myLocation={coordinates:n,accuracy:t.accuracy,latitude:t.latitude,longitude:t.longitude},this.getLocationTracking&&this.updateMyTrack(n),this.getNavigationActive&&this.updateNavigation(n)},toggleLocationTracking(){this.locationTracking=!this.locationTracking,this.locationTracking&&this.isCordova&&window.BackgroundGeolocation.configure({notificationTitle:"Location tracking",notificationText:"Tracking your location is in progress"}),this.locationTracking?this.startForeground():this.stopForeground()},stopNavigation(){this.navigationActive=!1,this.stopForeground(),this.updateNavigation([])},startNavigation(t){this.goTo=t,this.navigateTo.length===2&&(this.navigateTo[0]=this.goTo.getGeometry().getCoordinates()),this.isCordova&&window.BackgroundGeolocation.configure({notificationTitle:"Navigation",notificationText:"Navigation to a location is in progress"}),this.navigationActive=!0,this.startForeground()},startForeground(){this.foregroundLocationActivated||(this.isCordova&&window.BackgroundGeolocation.start(),this.foregroundLocationActivated=!0)},stopForeground(){this.foregroundLocationActivated&&this.foregroundNotNeeded&&(this.isCordova&&window.BackgroundGeolocation.stop(),this.foregroundLocationActivated=!1)},updateMyTrack(t){this.myTrack.push(t)},updateNavigation(t){this.navigateTo=t.length===0?[]:[this.goTo.getGeometry().getCoordinates(),t]}}}),wn={setup(){const t=G(),n=w(5),e=w("red");return{store:t,strokeWidth:n,strokeColor:e}},computed:{myTrack(){return this.store.getMyTrack}}};function kn(t,n,e,o,r,i){const a=_("ol-geom-line-string"),s=_("ol-style-stroke"),l=_("ol-style"),c=_("ol-feature"),u=_("ol-source-vector"),h=_("ol-vector-layer");return N(),E(h,null,{default:m(()=>[f(u,null,{default:m(()=>[f(c,null,{default:m(()=>[f(a,{coordinates:i.myTrack},null,8,["coordinates"]),f(l,null,{default:m(()=>[f(s,{color:o.strokeColor,width:o.strokeWidth},null,8,["color","width"])]),_:1})]),_:1})]),_:1})]),_:1})}var Ln=S(wn,[["render",kn]]);const Tn=B("div",{class:"q-space"});var Mn=at({name:"QSpace",setup(){return()=>Tn}});const Rn={setup(){const t=w(!0),n=w("top"),e=G(),o=w(3),r=w("green");return{dialog:t,position:n,store:e,strokeWidth:o,strokeColor:r}},data(){return{currentCenter:this.center,currentZoom:this.zoom,currentResolution:this.resolution,fixedCenter:!1,name:this.$route.query.name}},computed:{bearing(){return(([e,o],[r,i])=>{const a=r-e,s=i-o;return(Math.atan2(a,s)*180/Math.PI+360)%360})(this.store.getNavigateTo[1],this.store.getNavigateTo[0])-this.store.getRotation},navigateTo(){return this.store.getNavigateTo},navigationInProgress(){return this.store.getNavigateTo.length>0},distance(){const t=new it(this.store.getNavigateTo),n=Q(t);return n>1e3?(n/1e3).toFixed(2):parseInt(n)},distanceUnit(){const t=new it(this.store.getNavigateTo);return Q(t)>1e3?"km":"m"}},methods:{stopNavigation(){this.store.stopNavigation()}}},Pn={class:"text-weight-bold"},An={class:"text-grey"};function Nn(t,n,e,o,r,i){const a=_("ol-geom-line-string"),s=_("ol-style-stroke"),l=_("ol-style"),c=_("ol-feature"),u=_("ol-source-vector"),h=_("ol-vector-layer");return N(),st(ut,null,[f(Pt,{modelValue:i.navigationInProgress,"onUpdate:modelValue":n[0]||(n[0]=v=>i.navigationInProgress=v),position:o.position,seamless:"",class:"q-dialog__top50"},{default:m(()=>[f(Mt,{style:{width:"350px"}},{default:m(()=>[f(Rt,{class:"row items-center no-wrap"},{default:m(()=>[z("div",null,[z("div",Pn,$(t.$t("goTo"))+": "+$(r.name),1),z("div",An,$(t.$t("distance"))+": "+$(i.distance)+" "+$(i.distanceUnit),1)]),f(Mn),f(ct,{name:"navigation",style:lt({rotate:i.bearing+"deg"}),size:"lg"},null,8,["style"]),f(X,{flat:"",round:"",icon:"stop",onClick:i.stopNavigation},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","position"]),f(h,null,{default:m(()=>[f(u,null,{default:m(()=>[f(c,null,{default:m(()=>[f(a,{coordinates:i.navigateTo},null,8,["coordinates"]),f(l,null,{default:m(()=>[f(s,{color:o.strokeColor,width:o.strokeWidth},null,8,["color","width"])]),_:1})]),_:1})]),_:1})]),_:1})],64)}var In=S(Rn,[["render",Nn]]);const $n={props:["view"],emits:["centerChanged"],components:{TrackingLayer:Ln,NavigationLayer:In},setup(){const t=G(),n=w([]),e=w([]),{myLocation:o}=At(t);return{store:t,myLocationCoordinates:n,myLocationFeatures:e,myLocation:o}},computed:{rotation(){return this.store.getRotation}},watch:{myLocation(t,n){const e=gn([t.longitude,t.latitude],this.store.getMyLocationAccuracy);this.myLocationFeatures=[new Y(e.transform("EPSG:4326",this.store.getProjection)),new Y(new H(this.store.getMyLocationCoordinates))],this.myLocationCoordinates=t.coordinates,this.$emit("centerChanged",this.store.getMyLocationCoordinates)}}};function Fn(t,n,e,o,r,i){const a=_("ol-source-vector"),s=_("ol-vector-layer"),l=_("ol-overlay"),c=_("TrackingLayer"),u=_("NavigationLayer");return N(),st(ut,null,[f(s,null,{default:m(()=>[f(a,{features:o.myLocationFeatures},null,8,["features"])]),_:1}),o.myLocationFeatures.length>0?(N(),E(l,{key:0,position:o.myLocationCoordinates,positioning:"center-center"},{default:m(h=>[f(ct,{name:"navigation",class:Nt(h),style:lt({rotate:i.rotation+"deg"}),size:"lg"},null,8,["class","style"])]),_:1},8,["position"])):It("",!0),f(c),f(u)],64)}var Sn=S($n,[["render",Fn]]);const xn=$t({name:"IndexPage",components:{PageFullScreen:Cn,CartoLayers:Qt,LocationLayers:Sn},setup(){const t=G(),n=w([1637531,5766419]),e=w("EPSG:3857"),o=w(8),r=w([]),i=w(null),a=w("");return{store:t,center:n,projection:e,zoom:o,view:a,markLocations:r,goTo:i}},data(){if(this.$route.query.lat&&this.$route.query.lng){const t=gt([this.$route.query.lng,this.$route.query.lat]),n=new Y(new H(t));this.markLocations=[n],this.center=t,this.zoom=15,this.goTo=this.$route.query.navigate?n:null}return{currentCenter:this.center,currentZoom:this.zoom,currentResolution:this.resolution,fixedCenter:!1}},computed:{trackLocationIcon(){return this.store.getLocationTracking},navigationActive(){return this.store.getNavigationActive},isCenterFixed(){return this.fixedCenter}},methods:{zoomChanged(t){this.currentZoom=t},trackingClicked(t){this.store.toggleLocationTracking()},myLocationClicked(t){this.center=this.store.getMyLocationCoordinates,this.fixedCenter=!0,this.zoom=this.zoom<15?15:this.currentZoom},resolutionChanged(t){this.currentResolution=t},centerChanged(t){this.view!==""&&(this.currentCenter=t,this.view.getInteracting()?this.fixedCenter=!1:this.fixedCenter&&(this.center=t))}},watch:{view(t,n){this.store.initialize(t.getProjection()),this.goTo&&this.store.startNavigation(this.goTo)}}});function En(t,n,e,o,r,i){const a=_("ol-view"),s=_("CartoLayers"),l=_("LocationLayers"),c=_("ol-source-vector"),u=_("ol-vector-layer"),h=_("ol-map"),v=_("PageFullScreen");return N(),E(v,{style:{background:"#eee"}},{default:m(()=>[f(h,{loadTilesWhileAnimating:"",loadTilesWhileInteracting:"",style:{height:"100%"}},{default:m(()=>[f(a,{ref:"view",enableRotation:!1,center:t.center,zoom:t.zoom,projection:t.projection,onZoomChanged:t.zoomChanged,onCenterChanged:t.centerChanged,onResolutionChanged:t.resolutionChanged},null,8,["center","zoom","projection","onZoomChanged","onCenterChanged","onResolutionChanged"]),f(s),f(l,{view:t.view,onCenterChanged:t.centerChanged},null,8,["view","onCenterChanged"]),f(u,null,{default:m(()=>[f(c,{features:t.markLocations},null,8,["features"])]),_:1})]),_:1}),f(nt,{position:"bottom-left",offset:[18,18]},{default:m(()=>[f(X,{fab:"",icon:t.isCenterFixed?"my_location":"location_searching",color:"accent",onClick:t.myLocationClicked},null,8,["icon","onClick"])]),_:1}),f(nt,{position:"bottom-right",offset:[18,18]},{default:m(()=>[f(X,{fab:"",icon:t.trackLocationIcon?"stop_circle":"play_arrow",color:"accent",onClick:t.trackingClicked},null,8,["icon","onClick"])]),_:1})]),_:1})}var jn=S(xn,[["render",En]]);export{jn as default};
