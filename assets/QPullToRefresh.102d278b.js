import{T as F,b as I}from"./format.62b2ae12.js";import{s as B,a6 as L,a8 as O,r as m,c as y,bB as U,U as D,h as g,x as E,ac as k,g as Q,w as X,o as Y,ah as H,aN as V,ad as W,$ as G,as as A,Y as J}from"./index.315eb3dd.js";function K(){const l=new Map;return{getCache:function(o,h){return l[o]===void 0?l[o]=h:l[o]},getCacheWithFn:function(o,h){return l[o]===void 0?l[o]=h():l[o]}}}const R=[["left","center","start","width"],["right","center","end","width"],["top","start","center","height"],["bottom","end","center","height"]];var ee=B({name:"QSlideItem",props:{...L,leftColor:String,rightColor:String,topColor:String,bottomColor:String,onSlide:Function},emits:["action","top","right","bottom","left"],setup(l,{slots:o,emit:h}){const{proxy:w}=Q(),{$q:$}=w,c=O(l,$),{getCacheWithFn:b}=K(),d=m(null);let f=null,i={},p={},S={};const v=y(()=>$.lang.rtl===!0?{left:"right",right:"left"}:{left:"left",right:"right"}),M=y(()=>"q-slide-item q-item-type overflow-hidden"+(c.value===!0?" q-slide-item--dark q-dark":""));function C(){d.value.style.transform="translate(0,0)"}function _(t,s,n){l.onSlide!==void 0&&h("slide",{side:t,ratio:s,isReset:n})}function q(t){const s=d.value;if(t.isFirst)i={dir:null,size:{left:0,right:0,top:0,bottom:0},scale:0},s.classList.add("no-transition"),R.forEach(e=>{if(o[e[0]]!==void 0){const u=S[e[0]];u.style.transform="scale(1)",i.size[e[0]]=u.getBoundingClientRect()[e[3]]}}),i.axis=t.direction==="up"||t.direction==="down"?"Y":"X";else if(t.isFinal){s.classList.remove("no-transition"),i.scale===1?(s.style.transform=`translate${i.axis}(${i.dir*100}%)`,f!==null&&clearTimeout(f),f=setTimeout(()=>{f=null,h(i.showing,{reset:C}),h("action",{side:i.showing,reset:C})},230)):(s.style.transform="translate(0,0)",_(i.showing,0,!0));return}else t.direction=i.axis==="X"?t.offset.x<0?"left":"right":t.offset.y<0?"up":"down";if(o.left===void 0&&t.direction===v.value.right||o.right===void 0&&t.direction===v.value.left||o.top===void 0&&t.direction==="down"||o.bottom===void 0&&t.direction==="up"){s.style.transform="translate(0,0)";return}let n,r,a;i.axis==="X"?(r=t.direction==="left"?-1:1,n=r===1?v.value.left:v.value.right,a=t.distance.x):(r=t.direction==="up"?-2:2,n=r===2?"top":"bottom",a=t.distance.y),!(i.dir!==null&&Math.abs(r)!==Math.abs(i.dir))&&(i.dir!==r&&(["left","right","top","bottom"].forEach(e=>{p[e]&&(p[e].style.visibility=n===e?"visible":"hidden")}),i.showing=n,i.dir=r),i.scale=Math.max(0,Math.min(1,(a-40)/i.size[n])),s.style.transform=`translate${i.axis}(${a*r/Math.abs(r)}px)`,S[n].style.transform=`scale(${i.scale})`,_(n,i.scale,!1))}return U(()=>{p={},S={}}),D(()=>{f!==null&&clearTimeout(f)}),Object.assign(w,{reset:C}),()=>{const t=[],s={left:o[v.value.right]!==void 0,right:o[v.value.left]!==void 0,up:o.bottom!==void 0,down:o.top!==void 0},n=Object.keys(s).filter(a=>s[a]===!0);R.forEach(a=>{const e=a[0];o[e]!==void 0&&t.push(g("div",{ref:u=>{p[e]=u},class:`q-slide-item__${e} absolute-full row no-wrap items-${a[1]} justify-${a[2]}`+(l[e+"Color"]!==void 0?` bg-${l[e+"Color"]}`:"")},[g("div",{ref:u=>{S[e]=u}},o[e]())]))});const r=g("div",{key:`${n.length===0?"only-":""} content`,ref:d,class:"q-slide-item__content"},E(o.default));return n.length===0?t.push(r):t.push(k(r,b("dir#"+n.join(""),()=>{const a={prevent:!0,stop:!0,mouse:!0};return n.forEach(e=>{a[e]=!0}),[[F,q,void 0,a]]}))),g("div",{class:M.value},t)}}});const x=40,P=20;var te=B({name:"QPullToRefresh",props:{color:String,bgColor:String,icon:String,noMouse:Boolean,disable:Boolean,scrollTarget:{default:void 0}},emits:["refresh"],setup(l,{slots:o,emit:h}){const{proxy:w}=Q(),{$q:$}=w,c=m("pull"),b=m(0),d=m(!1),f=m(-x),i=m(!1),p=m({}),S=y(()=>({opacity:b.value,transform:`translateY(${f.value}px) rotate(${b.value*360}deg)`})),v=y(()=>"q-pull-to-refresh__puller row flex-center"+(i.value===!0?" q-pull-to-refresh__puller--animating":"")+(l.bgColor!==void 0?` bg-${l.bgColor}`:""));function M(e){if(e.isFinal===!0){d.value===!0&&(d.value=!1,c.value==="pulled"?(c.value="refreshing",r({pos:P}),q()):c.value==="pull"&&r({pos:-x,ratio:0}));return}if(i.value===!0||c.value==="refreshing")return!1;if(e.isFirst===!0){if(G(s)!==0||e.direction!=="down")return d.value===!0&&(d.value=!1,c.value="pull",r({pos:-x,ratio:0})),!1;d.value=!0;const{top:z,left:j}=t.getBoundingClientRect();p.value={top:z+"px",left:j+"px",width:window.getComputedStyle(t).getPropertyValue("width")}}A(e.evt);const u=Math.min(140,Math.max(0,e.distance.y));f.value=u-x,b.value=I(u/(P+x),0,1);const T=f.value>P?"pulled":"pull";c.value!==T&&(c.value=T)}const C=y(()=>{const e={down:!0};return l.noMouse!==!0&&(e.mouse=!0),[[F,M,void 0,e]]}),_=y(()=>`q-pull-to-refresh__content${d.value===!0?" no-pointer-events":""}`);function q(){h("refresh",()=>{r({pos:-x,ratio:0},()=>{c.value="pull"})})}let t,s,n=null;function r({pos:e,ratio:u},T){i.value=!0,f.value=e,u!==void 0&&(b.value=u),n!==null&&clearTimeout(n),n=setTimeout(()=>{n=null,i.value=!1,T&&T()},300)}function a(){s=J(t,l.scrollTarget)}return X(()=>l.scrollTarget,a),Y(()=>{t=w.$el,a()}),D(()=>{n!==null&&clearTimeout(n)}),Object.assign(w,{trigger:q,updateScrollTarget:a}),()=>{const e=[g("div",{class:_.value},E(o.default)),g("div",{class:"q-pull-to-refresh__puller-container fixed row flex-center no-pointer-events z-top",style:p.value},[g("div",{class:v.value,style:S.value},[c.value!=="refreshing"?g(H,{name:l.icon||$.iconSet.pullToRefresh.icon,color:l.color,size:"32px"}):g(V,{size:"24px",color:l.color})])])];return W("div",{class:"q-pull-to-refresh"},e,"main",l.disable===!1,()=>C.value)}}});export{te as Q,ee as a};
